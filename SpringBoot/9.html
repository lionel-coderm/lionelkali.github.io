<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>第九部分.“入门”指南 | lionel 技术栈</title>
    <meta name="description" content="技术改变生活">
    <link rel="icon" href="/logox.png">
    
    <link rel="preload" href="/assets/css/0.styles.400793ac.css" as="style"><link rel="preload" href="/assets/js/app.6b6e86e7.js" as="script"><link rel="preload" href="/assets/js/15.1fd61ce8.js" as="script"><link rel="prefetch" href="/assets/js/10.92dbe892.js"><link rel="prefetch" href="/assets/js/11.d76103e2.js"><link rel="prefetch" href="/assets/js/12.5b057577.js"><link rel="prefetch" href="/assets/js/13.54fb6ddb.js"><link rel="prefetch" href="/assets/js/14.b1a7d0d4.js"><link rel="prefetch" href="/assets/js/16.5decc9e0.js"><link rel="prefetch" href="/assets/js/17.efb9cc40.js"><link rel="prefetch" href="/assets/js/18.47cbd0e1.js"><link rel="prefetch" href="/assets/js/19.1d9cedb7.js"><link rel="prefetch" href="/assets/js/2.496cd5fd.js"><link rel="prefetch" href="/assets/js/20.c21b5687.js"><link rel="prefetch" href="/assets/js/21.cd15a9d7.js"><link rel="prefetch" href="/assets/js/22.64867988.js"><link rel="prefetch" href="/assets/js/23.1c906d57.js"><link rel="prefetch" href="/assets/js/24.3e681e08.js"><link rel="prefetch" href="/assets/js/25.b4976678.js"><link rel="prefetch" href="/assets/js/26.e83182d5.js"><link rel="prefetch" href="/assets/js/27.a2be4b00.js"><link rel="prefetch" href="/assets/js/28.e88115a0.js"><link rel="prefetch" href="/assets/js/29.cad83021.js"><link rel="prefetch" href="/assets/js/3.2abede73.js"><link rel="prefetch" href="/assets/js/30.6dac62b3.js"><link rel="prefetch" href="/assets/js/31.7896b337.js"><link rel="prefetch" href="/assets/js/32.cef33132.js"><link rel="prefetch" href="/assets/js/33.4be39fe9.js"><link rel="prefetch" href="/assets/js/34.a796beca.js"><link rel="prefetch" href="/assets/js/35.dbb67d71.js"><link rel="prefetch" href="/assets/js/36.5e24b7ac.js"><link rel="prefetch" href="/assets/js/37.98d16860.js"><link rel="prefetch" href="/assets/js/38.a2d836da.js"><link rel="prefetch" href="/assets/js/39.2867ffd2.js"><link rel="prefetch" href="/assets/js/4.e3439803.js"><link rel="prefetch" href="/assets/js/5.b5b2a085.js"><link rel="prefetch" href="/assets/js/6.336c7ff9.js"><link rel="prefetch" href="/assets/js/7.bc5180a4.js"><link rel="prefetch" href="/assets/js/8.dcfff2aa.js"><link rel="prefetch" href="/assets/js/9.34666713.js">
    <link rel="stylesheet" href="/assets/css/0.styles.400793ac.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">lionel 技术栈</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">学习</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/java/" class="nav-link">Java</a></li><li class="dropdown-item"><!----> <a href="/SpringBoot/" class="nav-link router-link-active">SpringBoot</a></li><li class="dropdown-item"><!----> <a href="/Spring/" class="nav-link">Spring</a></li><li class="dropdown-item"><!----> <a href="/MyBatis/" class="nav-link">MyBatis</a></li><li class="dropdown-item"><!----> <a href="/sql/" class="nav-link">数据库</a></li><li class="dropdown-item"><!----> <a href="/git/" class="nav-link">Git&amp;GitLab</a></li><li class="dropdown-item"><!----> <a href="/js/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">Linux</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">笔记</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/job/" class="nav-link">工作笔记</a></li><li class="dropdown-item"><!----> <a href="/OVR/" class="nav-link">重要记录</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">在线工具</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>在线编辑</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://smallpdf.com/cn/pdf-to-word" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PDF转换器
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.bejson.com/jsoneditoronline" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JSON编辑器
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.bejson.com/jsoneditoronline" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JSON编辑器
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://tableconvert.com/?output=text&amp;data=id%2C+name%2C+age%2C+gender%0D%0A1%2C+Lawrence%2C+39%2C+M%0D%0A2%2C+Oliver%2C+25%2C+M%0D%0A3%2C+Roberta%2C+17%2C+F%0D%0A4%2C+Bamboo%2C+70%2C+F%0D%0A" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MD表格生成器
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="http://cron.qqe2.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CRON表达式
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="http://tool.oschina.net/codeformat/html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  代码格式化
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://zh.numberempire.com/latexequationeditor.php" target="_blank" rel="noopener noreferrer" class="nav-link external">
  公式编辑器
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://cli.im/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  二维码生成器
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="http://tool.chinaz.com/tools/native_ascii.aspx" target="_blank" rel="noopener noreferrer" class="nav-link external">
  在线编码转换
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.toyaml.com/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  YAML&lt;-&gt;Properties
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>在线服务</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.bootcdn.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  BootCDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="http://cdn.code.baidu.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  百度CDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://qydev.weixin.qq.com/cdn/cdnjs.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微信CDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://code.aliyun.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  阿里代码库
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://my.rdc.aliyun.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  阿里自动部署
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>开源镜像</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://opsx.alibaba.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  OPSX
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://mirror.azure.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AZURE
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://hub.docker.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  DOCKER HUB
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>趋势分析</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://trends.google.com/trends/?geo=US" target="_blank" rel="noopener noreferrer" class="nav-link external">
  谷歌趋势
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="http://index.baidu.com/v2/index.html#/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  百度指数
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://tongji.baidu.com/data/browser" target="_blank" rel="noopener noreferrer" class="nav-link external">
  百度流量研究院
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div><div class="nav-item"><a href="/fx/" class="nav-link">分享</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/language/chinese.html" class="nav-link">Chinese</a></li><li class="dropdown-item"><!----> <a href="/language/japanese.html" class="nav-link">Japanese</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">学习</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/java/" class="nav-link">Java</a></li><li class="dropdown-item"><!----> <a href="/SpringBoot/" class="nav-link router-link-active">SpringBoot</a></li><li class="dropdown-item"><!----> <a href="/Spring/" class="nav-link">Spring</a></li><li class="dropdown-item"><!----> <a href="/MyBatis/" class="nav-link">MyBatis</a></li><li class="dropdown-item"><!----> <a href="/sql/" class="nav-link">数据库</a></li><li class="dropdown-item"><!----> <a href="/git/" class="nav-link">Git&amp;GitLab</a></li><li class="dropdown-item"><!----> <a href="/js/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">Linux</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">笔记</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/job/" class="nav-link">工作笔记</a></li><li class="dropdown-item"><!----> <a href="/OVR/" class="nav-link">重要记录</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">在线工具</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>在线编辑</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://smallpdf.com/cn/pdf-to-word" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PDF转换器
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.bejson.com/jsoneditoronline" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JSON编辑器
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.bejson.com/jsoneditoronline" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JSON编辑器
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://tableconvert.com/?output=text&amp;data=id%2C+name%2C+age%2C+gender%0D%0A1%2C+Lawrence%2C+39%2C+M%0D%0A2%2C+Oliver%2C+25%2C+M%0D%0A3%2C+Roberta%2C+17%2C+F%0D%0A4%2C+Bamboo%2C+70%2C+F%0D%0A" target="_blank" rel="noopener noreferrer" class="nav-link external">
  MD表格生成器
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="http://cron.qqe2.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CRON表达式
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="http://tool.oschina.net/codeformat/html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  代码格式化
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://zh.numberempire.com/latexequationeditor.php" target="_blank" rel="noopener noreferrer" class="nav-link external">
  公式编辑器
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://cli.im/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  二维码生成器
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="http://tool.chinaz.com/tools/native_ascii.aspx" target="_blank" rel="noopener noreferrer" class="nav-link external">
  在线编码转换
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.toyaml.com/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  YAML&lt;-&gt;Properties
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>在线服务</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.bootcdn.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  BootCDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="http://cdn.code.baidu.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  百度CDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://qydev.weixin.qq.com/cdn/cdnjs.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微信CDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://code.aliyun.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  阿里代码库
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://my.rdc.aliyun.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  阿里自动部署
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>开源镜像</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://opsx.alibaba.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  OPSX
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://mirror.azure.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AZURE
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://hub.docker.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  DOCKER HUB
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>趋势分析</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://trends.google.com/trends/?geo=US" target="_blank" rel="noopener noreferrer" class="nav-link external">
  谷歌趋势
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="http://index.baidu.com/v2/index.html#/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  百度指数
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://tongji.baidu.com/data/browser" target="_blank" rel="noopener noreferrer" class="nav-link external">
  百度流量研究院
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div><div class="nav-item"><a href="/fx/" class="nav-link">分享</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/language/chinese.html" class="nav-link">Chinese</a></li><li class="dropdown-item"><!----> <a href="/language/japanese.html" class="nav-link">Japanese</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>SpringBoot介绍</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>文档</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/SpringBoot/1.html" class="sidebar-link">第一部分SpringBoot文档</a></li><li><a href="/SpringBoot/2.html" class="sidebar-link">第二部分 Getting Started</a></li><li><a href="/SpringBoot/3.html" class="sidebar-link">第三部分使用SpringBoot</a></li><li><a href="/SpringBoot/4.html" class="sidebar-link">第四部分:SpringBoot特性</a></li><li><a href="/SpringBoot/5.html" class="sidebar-link">第五部分SpringBoot执行器:生产就绪的功能</a></li><li><a href="/SpringBoot/6.html" class="sidebar-link">第六部分.部署 Spring Boot 应用</a></li><li><a href="/SpringBoot/7.html" class="sidebar-link">第七部分.SpringBootCLI</a></li><li><a href="/SpringBoot/8.html" class="sidebar-link">第八部分.构建工具插件</a></li><li><a href="/SpringBoot/9.html" class="active sidebar-link">第九部分.“入门”指南</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_76-spring-boot-application" class="sidebar-link">76. Spring Boot Application</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_76-1创建您自己的故障分析器" class="sidebar-link">76.1创建您自己的故障分析器</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_76-2解决自动配置" class="sidebar-link">76.2解决自动配置</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_76-3在开始之前自定义环境或applicationcontext" class="sidebar-link">76.3在开始之前自定义环境或ApplicationContext</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_76-4构建applicationcontext层次结构-添加父上下文或根上下文" class="sidebar-link">76.4构建ApplicationContext层次结构(添加父上下文或根上下文)</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_76-5创建一个非web应用程序" class="sidebar-link">76.5创建一个非web应用程序</a></li></ul></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_77-属性和配置" class="sidebar-link">77. 属性和配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_77-1在构建时自动展开属性" class="sidebar-link">77.1在构建时自动展开属性</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_77-2外部化springapplication的配置" class="sidebar-link">77.2外部化SpringApplication的配置</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_77-3更改应用程序外部属性的位置" class="sidebar-link">77.3更改应用程序外部属性的位置</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_77-4使用“短”命令行参数" class="sidebar-link">77.4使用“短”命令行参数</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_77-5将yaml用于外部属性" class="sidebar-link">77.5将YAML用于外部属性</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_77-6-set-the-active-spring-profiles" class="sidebar-link">77.6 Set the Active Spring Profiles</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_77-7根据环境更改配置" class="sidebar-link">77.7根据环境更改配置</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_77-8发现外部属性的内置选项" class="sidebar-link">77.8发现外部属性的内置选项</a></li></ul></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_78-嵌入式web服务器" class="sidebar-link">78. 嵌入式Web服务器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_78-1使用另一个web服务器" class="sidebar-link">78.1使用另一个Web服务器</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_78-2禁用web服务器" class="sidebar-link">78.2禁用Web服务器</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_78-3更改http端口" class="sidebar-link">78.3更改HTTP端口</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_78-4使用随机未分配的http端口" class="sidebar-link">78.4使用随机未分配的HTTP端口</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_78-5在运行时发现http端口" class="sidebar-link">78.5在运行时发现HTTP端口</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_78-6启用http响应压缩" class="sidebar-link">78.6启用HTTP响应压缩</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_78-7配置ssl" class="sidebar-link">78.7配置SSL</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_78-8配置http-2" class="sidebar-link">78.8配置HTTP / 2</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_78-9配置web服务器" class="sidebar-link">78.9配置Web服务器</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_78-10向应用程序添加servlet，过滤器或监听器" class="sidebar-link">78.10向应用程序添加Servlet，过滤器或监听器</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_78-11配置访问日志记录" class="sidebar-link">78.11配置访问日志记录</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_78-12在前端代理服务器后面运行" class="sidebar-link">78.12在前端代理服务器后面运行</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_78-13使用tomcat启用多个连接器" class="sidebar-link">78.13使用Tomcat启用多个连接器</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_78-14使用tomcat的legacycookieprocessor" class="sidebar-link">78.14使用Tomcat的LegacyCookieProcessor</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_78-15使用undertow启用多个侦听器" class="sidebar-link">78.15使用Undertow启用多个侦听器</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_78-16使用-serverendpoint创建websocket端点" class="sidebar-link">78.16使用@ServerEndpoint创建WebSocket端点</a></li></ul></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_79-spring-mvc" class="sidebar-link">79.Spring MVC</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_79-1编写json-rest服务" class="sidebar-link">79.1编写JSON REST服务</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_79-2编写xml-rest服务" class="sidebar-link">79.2编写XML REST服务</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_79-3自定义jackson-objectmapper" class="sidebar-link">79.3自定义Jackson ObjectMapper</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_79-4自定义-responsebody渲染" class="sidebar-link">79.4自定义@ResponseBody渲染</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_79-5处理多部分文件上载" class="sidebar-link">79.5处理多部分文件上载</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_79-6关闭spring-mvc-dispatcherservlet" class="sidebar-link">79.6关闭Spring MVC DispatcherServlet</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_79-7关闭默认mvc配置" class="sidebar-link">79.7关闭默认MVC配置</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_79-8自定义viewresolvers" class="sidebar-link">79.8自定义ViewResolvers</a></li></ul></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_80-使用spring-security进行测试" class="sidebar-link">80.使用Spring Security进行测试</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_81-jersey" class="sidebar-link">81.Jersey</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_81-1使用spring-security保护jersey端点" class="sidebar-link">81.1使用Spring Security保护Jersey端点</a></li></ul></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_82-http客户端" class="sidebar-link">82.HTTP客户端</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_82-1配置resttemplate以使用代理" class="sidebar-link">82.1配置RestTemplate以使用代理</a></li></ul></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_83-logging" class="sidebar-link">83. Logging</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_83-1配置日志记录的日志记录" class="sidebar-link">83.1配置日志记录的日志记录</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_83-2配置log4j进行日志记录" class="sidebar-link">83.2配置Log4j进行日志记录</a></li></ul></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_84-数据访问" class="sidebar-link">84.数据访问</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_84-1配置自定义数据源" class="sidebar-link">84.1配置自定义数据源</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_84-2配置两个数据源" class="sidebar-link">84.2配置两个数据源</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_84-3使用spring-data-repositories" class="sidebar-link">84.3使用Spring Data Repositories</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_84-4从spring配置中分离-entity定义" class="sidebar-link">84.4从Spring配置中分离@Entity定义</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_84-5配置jpa属性" class="sidebar-link">84.5配置JPA属性</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_84-6配置hibernate命名策略" class="sidebar-link">84.6配置Hibernate命名策略</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_84-7配置hibernate二级缓存" class="sidebar-link">84.7配置Hibernate二级缓存</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_84-8在hibernate组件中使用依赖注入" class="sidebar-link">84.8在Hibernate组件中使用依赖注入</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_84-9使用自定义entitymanagerfactory" class="sidebar-link">84.9使用自定义EntityManagerFactory</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_84-10使用两个entitymanagers" class="sidebar-link">84.10使用两个EntityManagers</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_84-11使用传统的persistence-xml文件" class="sidebar-link">84.11使用传统的persistence.xml文件</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_84-12使用spring-data-jpa和mongo存储库" class="sidebar-link">84.12使用Spring Data JPA和Mongo存储库</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_84-13自定义spring-data的web支持" class="sidebar-link">84.13自定义Spring Data的Web支持</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_84-14将spring数据存储库公开为rest端点" class="sidebar-link">84.14将Spring数据存储库公开为REST端点</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_84-15配置jpa使用的组件" class="sidebar-link">84.15配置JPA使用的组件</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_84-16使用两个datasource配置jooq" class="sidebar-link">84.16使用两个DataSource配置jOOQ</a></li></ul></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_85-数据库初始化" class="sidebar-link">85.数据库初始化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_85-1使用jpa初始化数据库" class="sidebar-link">85.1使用JPA初始化数据库</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_85-2使用hibernate初始化数据库" class="sidebar-link">85.2使用Hibernate初始化数据库</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_85-3初始化数据库" class="sidebar-link">85.3初始化数据库</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_85-4初始化spring-batch数据库" class="sidebar-link">85.4初始化Spring Batch数据库</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_85-5使用更高级别的数据库迁移工具" class="sidebar-link">85.5使用更高级别的数据库迁移工具</a></li></ul></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_86-messaging" class="sidebar-link">86. Messaging</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_86-1禁用已事务处理的jms会话" class="sidebar-link">86.1禁用已事务处理的JMS会话</a></li></ul></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_87-批量申请" class="sidebar-link">87.批量申请</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_87-1在启动时执行spring批处理作业" class="sidebar-link">87.1在启动时执行Spring批处理作业</a></li></ul></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_88-执行器" class="sidebar-link">88.执行器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_88-1更改执行器端点的http端口或地址" class="sidebar-link">88.1更改执行器端点的HTTP端口或地址</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_88-2自定义-whitelabel-错误页面" class="sidebar-link">88.2自定义'whitelabel'错误页面</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_88-3消除敏感价值" class="sidebar-link">88.3消除敏感价值</a></li></ul></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_89-安全" class="sidebar-link">89.安全</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_89-1关闭spring-boot安全配置" class="sidebar-link">89.1关闭Spring Boot安全配置</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_89-2更改userdetailsservice和添加用户帐户" class="sidebar-link">89.2更改UserDetailsService和添加用户帐户</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_89-3在代理服务器后面运行时启用https" class="sidebar-link">89.3在代理服务器后面运行时启用HTTPS</a></li></ul></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_90-热插拔" class="sidebar-link">90.热插拔</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_90-1重新加载静态内容" class="sidebar-link">90.1重新加载静态内容</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_90-2重新加载模板而不重新启动容器" class="sidebar-link">90.2重新加载模板而不重新启动容器</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_90-3快速应用程序重新启动" class="sidebar-link">90.3快速应用程序重新启动</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_90-4重新加载java类而不重新启动容器" class="sidebar-link">90.4重新加载Java类而不重新启动容器</a></li></ul></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_91-建立" class="sidebar-link">91.建立</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_91-1生成构建信息" class="sidebar-link">91.1生成构建信息</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_91-2生成git信息" class="sidebar-link">91.2生成Git信息</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_91-3自定义依赖版本" class="sidebar-link">91.3自定义依赖版本</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_91-4使用maven创建可执行jar" class="sidebar-link">91.4使用Maven创建可执行JAR</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_91-5使用spring-boot应用程序作为依赖项" class="sidebar-link">91.5使用Spring Boot应用程序作为依赖项</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_91-6可执行jar运行时提取特定库" class="sidebar-link">91.6可执行jar运行时提取特定库</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_91-7使用排除项创建不可执行的jar" class="sidebar-link">91.7使用排除项创建不可执行的JAR</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_91-8从maven开始远程调试spring-boot应用程序" class="sidebar-link">91.8从Maven开始远程调试Spring Boot应用程序</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_91-9在不使用spring-boot-antlib的情况下从ant构建可执行文件" class="sidebar-link">91.9在不使用spring-boot-antlib的情况下从Ant构建可执行文件</a></li></ul></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_92-传统部署" class="sidebar-link">92.传统部署</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_92-1创建可部署的war文件" class="sidebar-link">92.1创建可部署的war文件</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_92-2将现有应用程序转换为spring-boot" class="sidebar-link">92.2将现有应用程序转换为Spring Boot</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_92-3将war部署到weblogic" class="sidebar-link">92.3将WAR部署到WebLogic</a></li><li class="sidebar-sub-header"><a href="/SpringBoot/9.html#_92-4使用jedis代替lettuce" class="sidebar-link">92.4使用Jedis代替Lettuce</a></li></ul></li></ul></li><li><a href="/SpringBoot/10.html" class="sidebar-link">十.附录部分</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>java面向对象</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="第九部分-“入门”指南"><a href="#第九部分-“入门”指南" aria-hidden="true" class="header-anchor">#</a> 第九部分.“入门”指南</h1> <p>本节提供了使用Spring Boot时经常出现的一些常见“我该怎么做......”的问题的答案。 它的报道并不详尽，但确实涵盖了很多。</p> <p>如果您遇到我们未在此处讨论的特定问题，您可能需要查看stackoverflow.com以查看是否有人已提供答案。 这也是提出新问题的好地方（请使用spring-boot标签）。</p> <p>我们也非常乐意扩展这一部分。 如果您想添加“操作方法”，请向我们发送拉取请求。</p> <h2 id="_76-spring-boot-application"><a href="#_76-spring-boot-application" aria-hidden="true" class="header-anchor">#</a> 76. Spring Boot Application</h2> <p>本节包括与Spring引导应用程序直接相关的主题。</p> <h3 id="_76-1创建您自己的故障分析器"><a href="#_76-1创建您自己的故障分析器" aria-hidden="true" class="header-anchor">#</a> 76.1创建您自己的故障分析器</h3> <p>FailureAnalyzer是一种在启动时拦截异常并将其转换为人类可读消息的好方法，包含在FailureAnalysis中。 Spring Boot为应用程序上下文相关异常，JSR-303验证等提供了这样的分析器。 您也可以创建自己的。</p> <p>AbstractFailureAnalyzer是FailureAnalyzer的一个方便扩展，它检查要处理的异常中是否存在指定的异常类型。 您可以从中进行扩展，以便您的实现只有在实际存在时才有机会处理异常。 如果由于某种原因，您无法处理异常，则返回null以使另一个实现有机会处理异常。</p> <p>FailureAnalyzer实现必须在META-INF / spring.factories中注册。 以下示例注册ProjectConstraintViolationFailureAnalyzer：</p> <div class="language- extra-class"><pre class="language-text"><code>org.springframework.boot.diagnostics.FailureAnalyzer=\
com.example.ProjectConstraintViolationFailureAnalyzer
</code></pre></div><blockquote><p>如果需要访问BeanFactory或环境，故障分析器可以分别实现BeanFactoryAware和EnvironmentAware。</p></blockquote> <h3 id="_76-2解决自动配置"><a href="#_76-2解决自动配置" aria-hidden="true" class="header-anchor">#</a> 76.2解决自动配置</h3> <p>Spring Boot自动配置尽力“做正确的事”，但有时事情会失败，而且很难说清楚原因。</p> <p>任何Spring Boot ApplicationContext都有一个非常有用的ConditionEvaluationReport。 如果启用DEBUG日志记录输出，则可以看到它。 如果使用spring-boot-actuator（参见Actuator章节），还有一个条件端点以JSON格式呈现报表。 使用该端点调试应用程序，并查看Spring Boot在运行时添加了哪些功能（以及哪些尚未添加）。</p> <p>通过查看源代码和Javadoc可以回答更多问题。 阅读代码时，请记住以下经验法则：</p> <ul><li>查找名为<em>自动配置的类并读取其源代码。请特别注意@conditional</em>注释，以了解它们启用的功能以及何时启用。添加——调试到命令行或系统属性——DDebug，以便在控制台上获取应用程序中做出的所有自动配置决策的日志。在正在运行的执行器应用程序中，查看条件端点（/actuator/conditions或JMX等效项）以获取相同的信息。</li> <li>查找@configurationproperties（如serverproperties）类，并从中读取可用的外部配置选项。@configurationproperties注释有一个name属性，用作外部属性的前缀。因此，server properties的前缀为“server”，其配置属性为server.port、server.address和其他。在正在运行的执行器应用程序中，查看configprops端点。</li> <li>在绑定器上查找bind方法的用法，以轻松的方式将配置值显式地从环境中拉出。它通常与前缀一起使用。</li> <li>寻找直接绑定到环境的@Value注释。</li> <li>查找@conditionalonexpression注释，这些注释根据spel表达式打开和关闭功能，通常使用环境中解析的占位符进行计算。</li></ul> <h3 id="_76-3在开始之前自定义环境或applicationcontext"><a href="#_76-3在开始之前自定义环境或applicationcontext" aria-hidden="true" class="header-anchor">#</a> 76.3在开始之前自定义环境或ApplicationContext</h3> <p>SpringApplication具有ApplicationListeners和ApplicationContextInitializers，用于将自定义应用于上下文或环境。 Spring Boot加载了许多此类自定义项，以便在META-INF / spring.factories内部使用。 注册其他自定义项的方法不止一种：</p> <ul><li>按程序编程，通过在运行之前调用SpringApplication上的addListeners和addInitializers方法。</li> <li>声明性地，根据应用程序，通过设置context.initializer.classes或context.listener.classes属性。</li> <li>声明性地，对于所有应用程序，通过添加META-INF / spring.factories并打包应用程序全部用作库的jar文件。</li></ul> <p>SpringApplication向侦听器发送一些特殊的ApplicationEvent（有些甚至在创建上下文之前），然后为ApplicationContext发布的事件注册侦听器。 有关完整列表，请参见“Spring Boot功能”部分中的“第23.5节”“应用程序事件和监听器”。</p> <p>在使用EnvironmentPostProcessor刷新应用程序上下文之前，还可以自定义环境。 每个实现都应该在META-INF / spring.factories中注册，如以下示例所示：</p> <div class="language- extra-class"><pre class="language-text"><code>org.springframework.boot.env.EnvironmentPostProcessor=com.example.YourEnvironmentPostProcessor
</code></pre></div><p>该实现可以加载任意文件并将其添加到环境中。例如，下面的示例从类路径加载一个YAML配置文件:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EnvironmentPostProcessorExample</span> <span class="token keyword">implements</span> <span class="token class-name">EnvironmentPostProcessor</span> <span class="token punctuation">{</span>

	<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">YamlPropertySourceLoader</span> loader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">YamlPropertySourceLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">postProcessEnvironment</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableEnvironment</span> environment<span class="token punctuation">,</span>
			<span class="token class-name">SpringApplication</span> application<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">Resource</span> path <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span><span class="token string">&quot;com/example/myapp/config.yml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">PropertySource</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> propertySource <span class="token operator">=</span> <span class="token function">loadYaml</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
		environment<span class="token punctuation">.</span><span class="token function">getPropertySources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span>propertySource<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">private</span> <span class="token class-name">PropertySource</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">loadYaml</span><span class="token punctuation">(</span><span class="token class-name">Resource</span> path<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>path<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;Resource &quot;</span> <span class="token operator">+</span> path <span class="token operator">+</span> <span class="token string">&quot; does not exist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">try</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>loader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&quot;custom-resource&quot;</span><span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span>
					<span class="token string">&quot;Failed to load yaml configuration from &quot;</span> <span class="token operator">+</span> path<span class="token punctuation">,</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>环境已经准备好了Spring Boot默认加载的所有常用属性源。 因此，可以从环境中获取文件的位置。 前面的示例在列表的末尾添加了custom-resource属性source，以便在任何通常的其他位置中定义的键优先。 自定义实现可以定义另一个订单。</p></blockquote> <blockquote><p>警告
虽然在@SpringBootApplication上使用@PropertySource似乎是在环境中加载自定义资源的一种方便而简单的方法，但我们不建议这样做，因为Spring Boot会在刷新ApplicationContext之前准备环境。 使用@PropertySource定义的任何键加载太晚都不会对自动配置产生任何影响。</p></blockquote> <h3 id="_76-4构建applicationcontext层次结构-添加父上下文或根上下文"><a href="#_76-4构建applicationcontext层次结构-添加父上下文或根上下文" aria-hidden="true" class="header-anchor">#</a> 76.4构建ApplicationContext层次结构(添加父上下文或根上下文)</h3> <p>您可以使用ApplicationBuilder类来创建父/子ApplicationContext层次结构。有关更多信息，请参见“Spring Boot features”一节中的“Section 23.4，”Fluent Builder API“。</p> <h3 id="_76-5创建一个非web应用程序"><a href="#_76-5创建一个非web应用程序" aria-hidden="true" class="header-anchor">#</a> 76.5创建一个非web应用程序</h3> <p>并非所有Spring应用程序都必须是Web应用程序（或Web服务）。 如果要在main方法中执行某些代码，还要引导Spring应用程序来设置要使用的基础结构，则可以使用Spring Boot的SpringApplication功能。 SpringApplication更改其ApplicationContext类，具体取决于它是否认为它需要Web应用程序。 您可以做的第一件事就是将与服务器相关的依赖项（例如servlet API）从类路径中删除。 如果您不能这样做（例如，您从相同的代码库运行两个应用程序），那么您可以在SpringApplication实例上显式调用setWebApplicationType（WebApplicationType.NONE）或设置applicationContextClass属性（通过Java API或外部属性）。 您希望作为业务逻辑运行的应用程序代码可以作为CommandLineRunner实现，并作为@Bean定义放入上下文中。</p> <h2 id="_77-属性和配置"><a href="#_77-属性和配置" aria-hidden="true" class="header-anchor">#</a> 77. 属性和配置</h2> <p>本节包括有关设置和读取属性、配置设置及其与Spring引导应用程序的交互的主题。</p> <h3 id="_77-1在构建时自动展开属性"><a href="#_77-1在构建时自动展开属性" aria-hidden="true" class="header-anchor">#</a> 77.1在构建时自动展开属性</h3> <p>您可以通过使用现有的构建配置自动扩展它们，而不是硬编码项目的构建配置中指定的一些属性。这在Maven和Gradle中都是可能的。</p> <h4 id="_77-1-1使用maven自动扩展属性"><a href="#_77-1-1使用maven自动扩展属性" aria-hidden="true" class="header-anchor">#</a> 77.1.1使用Maven自动扩展属性</h4> <p>通过使用资源筛选，可以自动扩展Maven项目中的属性。如果使用spring-boot-starter-parent，则可以使用@..引用Maven的“项目属性”。@占位符，如下例所示:</p> <div class="language- extra-class"><pre class="language-text"><code>app.encoding=@project.build.sourceEncoding@
app.java.version=@java.version@
</code></pre></div><blockquote><p>只有生产配置以这种方式过滤(换句话说，src/test/resources上不应用过滤)。</p></blockquote> <blockquote><p>如果启用addResources标志，则spring-boot：run目标可以将src / main / resources直接添加到类路径中（用于热重新加载）。 这样做可以绕过资源过滤和此功能。 相反，您可以使用exec：java目标或自定义插件的配置。 有关详细信息，请参阅插件使用情况页面。</p></blockquote> <p>如果不使用starter父元素，则需要在pom.xml的<build></build>元素中包含以下元素:</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resources</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resource</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>directory</span><span class="token punctuation">&gt;</span></span>src/main/resources<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>directory</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filtering</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filtering</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resource</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resources</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>您还需要在<plugins></plugins>中包含以下元素:</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>maven-resources-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>delimiters</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>delimiter</span><span class="token punctuation">&gt;</span></span>@<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>delimiter</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>delimiters</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>useDefaultDelimiters</span><span class="token punctuation">&gt;</span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>useDefaultDelimiters</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><blockquote><p>如果在配置中使用标准Spring占位符(例如${占位符})，则usedefaultdelimiter属性非常重要。如果该属性未设置为false，则可以通过构建扩展这些属性。</p></blockquote> <h4 id="_77-1-2自动性能扩展使用级联"><a href="#_77-1-2自动性能扩展使用级联" aria-hidden="true" class="header-anchor">#</a> 77.1.2自动性能扩展使用级联</h4> <p>您可以通过配置Java插件的processResources任务来自动展开Gradle项目中的属性，如下面的示例所示:</p> <div class="language- extra-class"><pre class="language-text"><code>processResources {
	expand(project.properties)
}
</code></pre></div><p>然后，您可以使用占位符引用Gradle项目的属性，如下面的示例所示:</p> <div class="language- extra-class"><pre class="language-text"><code>app.name=${name}
app.description=${description}
</code></pre></div><blockquote><p>Gradle的扩展方法使用Groovy的SimpleTemplateEngine，它转换${..}标记。$ {. .风格与Spring自己的属性占位符机制冲突。要将Spring属性占位符与自动展开一起使用，请转义Spring属性占位符如下:${..}。</p></blockquote> <h3 id="_77-2外部化springapplication的配置"><a href="#_77-2外部化springapplication的配置" aria-hidden="true" class="header-anchor">#</a> 77.2外部化SpringApplication的配置</h3> <p>spring应用程序具有bean属性(主要是setter)，因此您可以在创建应用程序时使用它的Java API来修改其行为。或者，您可以通过在spring.main.*中设置属性来具体化配置。例如，在应用中。属性，您可能有以下设置:</p> <div class="language- extra-class"><pre class="language-text"><code>spring.main.web-application-type=none
spring.main.banner-mode=off
</code></pre></div><p>然后在启动时不打印Spring Boot横幅，并且应用程序未启动嵌入式Web服务器。</p> <p>外部配置中定义的属性将覆盖使用Java API指定的值，但用于创建ApplicationContext的源的明显例外。 考虑以下应用程序：</p> <div class="language- extra-class"><pre class="language-text"><code>new SpringApplicationBuilder()
	.bannerMode(Banner.Mode.OFF)
	.sources(demo.MyApp.class)
	.run(args);
</code></pre></div><p>现在考虑以下配置:</p> <div class="language- extra-class"><pre class="language-text"><code>spring.main.sources=com.acme.Config,com.acme.ExtraConfig
spring.main.banner-mode=console
</code></pre></div><p>实际应用程序现在显示横幅（由配置覆盖）并使用ApplicationContext的三个源（按以下顺序）：demo.MyApp，com.acme.Config和com.acme.ExtraConfig。</p> <h3 id="_77-3更改应用程序外部属性的位置"><a href="#_77-3更改应用程序外部属性的位置" aria-hidden="true" class="header-anchor">#</a> 77.3更改应用程序外部属性的位置</h3> <p>默认情况下，来自不同源的属性将按照定义的顺序添加到Spring Environment中（有关确切的顺序，请参阅“Spring Boot features”部分中的“第24章，外部化配置”）。</p> <p>增加和修改此排序的一种好方法是将@PropertySource注释添加到应用程序源。 传递给SpringApplication静态便捷方法的类和使用setSources（）添加的类将被检查以查看它们是否具有@PropertySources。 如果这样做，那么这些属性会尽早添加到Environment中，以便在ApplicationContext生命周期的所有阶段中使用。 以这种方式添加的属性的优先级低于使用默认位置（例如application.properties），系统属性，环境变量或命令行添加的属性。</p> <p>您还可以提供以下系统属性（或环境变量）来更改行为：</p> <ul><li>spring.config.name（SPRING_CONFIG_NAME）：默认为application作为文件名的根。</li> <li>spring.config.location（SPRING_CONFIG_LOCATION）：要加载的文件（例如类路径资源或URL）。 为此文档设置了一个单独的Environment属性源，它可以被系统属性，环境变量或命令行覆盖。</li></ul> <p>无论您在环境中设置什么，Spring Boot始终如上所述加载application.properties。 默认情况下，如果使用YAML，则扩展名为“.yml”的文件也会添加到列表中。</p> <p>Spring Boot记录在DEBUG级别加载的配置文件以及在TRACE级别找不到的候选项。</p> <p>有关更多详细信息，请参阅ConfigFileApplicationListener。</p> <h3 id="_77-4使用“短”命令行参数"><a href="#_77-4使用“短”命令行参数" aria-hidden="true" class="header-anchor">#</a> 77.4使用“短”命令行参数</h3> <p>有些人喜欢使用（例如）--port = 9000而不是--server.port = 9000来在命令行上设置配置属性。 您可以通过在application.properties中使用占位符来启用此行为，如以下示例所示：</p> <div class="language- extra-class"><pre class="language-text"><code>server.port=${port:8080}
</code></pre></div><blockquote><p>如果从spring-boot-starter-parent POM继承，则maven-resources-plugins的默认过滤器令牌已从$ {*}更改为@（即@ maven.token @而不是$ {maven。 令牌}）以防止与Spring样式的占位符冲突。 如果您已直接为application.properties启用了Maven筛选，则可能还需要更改默认筛选器标记以使用其他分隔符。</p></blockquote> <blockquote><p>在这种特殊情况下，端口绑定在PaaS环境中工作，比如Heroku或Cloud Foundry。在这两个平台中，端口环境变量是自动设置的，Spring可以绑定到环境属性的大写同义词。</p></blockquote> <h3 id="_77-5将yaml用于外部属性"><a href="#_77-5将yaml用于外部属性" aria-hidden="true" class="header-anchor">#</a> 77.5将YAML用于外部属性</h3> <p>YAML是JSON的超集，因此，它是以分层格式存储外部属性的便捷语法，如以下示例所示：</p> <div class="language- extra-class"><pre class="language-text"><code>spring:
	application:
		name: cruncher
	datasource:
		driverClassName: com.mysql.jdbc.Driver
		url: jdbc:mysql://localhost/test
server:
	port: 9000
</code></pre></div><p>创建一个名为application.yml的文件，并将其放在类路径的根目录中。 然后将snakeyaml添加到依赖项中（Maven坐标org.yaml：snakeyaml，如果使用spring-boot-starter则已包含在内）。 将YAML文件解析为Java Map &lt;String，Object&gt;（类似于JSON对象），并且Spring Boot将地图展平，使其深度为一级并具有句点分隔的键，因为许多人习惯使用属性文件 在Java中。</p> <p>上面的示例YAML对应于以下application.properties文件：</p> <div class="language- extra-class"><pre class="language-text"><code>spring.application.name=cruncher
spring.datasource.driverClassName=com.mysql.jdbc.Driver
spring.datasource.url=jdbc:mysql://localhost/test
server.port=9000
</code></pre></div><p>有关YAML的更多信息，请参见“Spring Boot features”部分中的“第24.7节”，“使用YAML而不是属性”。</p> <h3 id="_77-6-set-the-active-spring-profiles"><a href="#_77-6-set-the-active-spring-profiles" aria-hidden="true" class="header-anchor">#</a> 77.6 Set the Active Spring Profiles</h3> <p>Spring Environment有一个API，但你通常会设置一个System属性（spring.profiles.active）或一个OS环境变量（SPRING_PROFILES_ACTIVE）。 此外，您可以使用-D参数启动应用程序（请记住将其放在主类或jar存档之前），如下所示：</p> <div class="language- extra-class"><pre class="language-text"><code>$ java -jar -Dspring.profiles.active=production demo-0.0.1-SNAPSHOT.jar
</code></pre></div><p>在Spring Boot中，您还可以在application.properties中设置活动配置文件，如以下示例所示：</p> <div class="language- extra-class"><pre class="language-text"><code>spring.profiles.active=production
</code></pre></div><p>以这种方式设置的值将由System属性或环境变量设置替换，但不会由SpringApplicationBuilder.profiles（）方法替换。 因此，后一个Java API可用于扩充配置文件而不更改默认值。</p> <p>有关详细信息，请参阅“Spring Boot功能”部分中的“第25章，配置文件”。</p> <h3 id="_77-7根据环境更改配置"><a href="#_77-7根据环境更改配置" aria-hidden="true" class="header-anchor">#</a> 77.7根据环境更改配置</h3> <p>YAML文件实际上是由---行分隔的文档序列，每个文档分别解析为展平的地图。</p> <p>如果YAML文档包含spring.profiles键，则配置文件值（以逗号分隔的配置文件列表）将输入Spring Environment.acceptsProfiles（）方法。 如果这些配置文件中的任何一个处于活动状态，则该文档将包含在最终合并中（否则，它不包含在内），如以下示例所示：</p> <div class="language- extra-class"><pre class="language-text"><code>server:
	port: 9000
---

spring:
	profiles: development
server:
	port: 9001

---

spring:
	profiles: production
server:
	port: 0
</code></pre></div><p>在前面的示例中，默认端口为9000.但是，如果名为“development”的Spring配置文件处于活动状态，则端口为9001.如果“production”处于活动状态，则端口为0。</p> <blockquote><p>YAML文档按照遇到它们的顺序合并。较晚的值覆盖较早的值。</p></blockquote> <p>要对属性文件执行相同的操作，可以使用application-${profile}。属性来指定配置文件特定的值。</p> <h3 id="_77-8发现外部属性的内置选项"><a href="#_77-8发现外部属性的内置选项" aria-hidden="true" class="header-anchor">#</a> 77.8发现外部属性的内置选项</h3> <p>Spring Boot在运行时将外部属性从application.properties（或.yml文件和其他位置）绑定到应用程序中。 没有（并且在技术上不可能）单个位置中所有受支持属性的详尽列表，因为贡献可以来自类路径上的其他jar文件。</p> <p>具有Actuator功能的正在运行的应用程序具有configprops端点，该端点显示通过@ConfigurationProperties可用的所有绑定和可绑定属性。</p> <p>附录包含一个application.properties示例，其中包含Spring Boot支持的最常见属性的列表。 最终列表来自于搜索@ConfigurationProperties和@Value注释的源代码以及偶尔使用Binder。 有关加载属性的确切顺序的更多信息，请参见“第24章，外部化配置”。</p> <h2 id="_78-嵌入式web服务器"><a href="#_78-嵌入式web服务器" aria-hidden="true" class="header-anchor">#</a> 78. 嵌入式Web服务器</h2> <p>每个Spring Boot Web应用程序都包含一个嵌入式Web服务器。 此功能会导致许多操作方法问题，包括如何更改嵌入式服务器以及如何配置嵌入式服务器。 本节回答了这些问题。</p> <h3 id="_78-1使用另一个web服务器"><a href="#_78-1使用另一个web服务器" aria-hidden="true" class="header-anchor">#</a> 78.1使用另一个Web服务器</h3> <p>许多Spring启动器都包含默认的嵌入式容器。</p> <ul><li>对于servlet堆栈应用程序，spring-boot-starter-web包括tomcat，包括spring-boot-starter-tomcat，但你可以使用spring-boot-starter-jetty或spring-boot-starter-undertow。</li> <li>对于反应堆栈应用，spring-boot-starter-webflux包括反应器网络，包括spring-boot-starter-reactor-netty，但你可以使用spring-boot-starter-tomcat，spring-boot-starter-jetty或spring -boot-starter-undertow相反。</li></ul> <p>切换到其他HTTP服务器时，除了包含所需的依赖项外，还需要排除默认依赖项。 Spring Boot为HTTP服务器提供单独的启动程序，以帮助使此过程尽可能简单。</p> <p>以下Maven示例显示如何排除Tomcat并为Spring MVC包含Jetty：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-api.version</span><span class="token punctuation">&gt;</span></span>3.1.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-api.version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!-- Exclude the Tomcat dependency --&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-tomcat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- Use Jetty instead --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-jetty<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Servlet API的版本已经被覆盖，与Tomcat 9和Undertow 2.0不同，Jetty 9.4不支持Servlet 4.0。</p> <p>下面的Gradle例子展示了如何排除Netty和包括对Spring WebFlux的Undertow:</p> <div class="language- extra-class"><pre class="language-text"><code>configurations {
	// exclude Reactor Netty
	compile.exclude module: 'spring-boot-starter-reactor-netty'
}

dependencies {
	compile 'org.springframework.boot:spring-boot-starter-webflux'
	// Use Undertow instead
	compile 'org.springframework.boot:spring-boot-starter-undertow'
	// ...
}
</code></pre></div><blockquote><p>spring-boot-starter-reactor-netty需要使用WebClient类，因此即使需要包含不同的HTTP服务器，也可能需要依赖Netty。</p></blockquote> <h3 id="_78-2禁用web服务器"><a href="#_78-2禁用web服务器" aria-hidden="true" class="header-anchor">#</a> 78.2禁用Web服务器</h3> <p>如果您的类路径包含启动Web服务器所需的位，Spring Boot将自动启动它。 要禁用此行为，请在application.properties中配置WebApplicationType，如以下示例所示：</p> <div class="language- extra-class"><pre class="language-text"><code>spring.main.web-application-type=none
</code></pre></div><h3 id="_78-3更改http端口"><a href="#_78-3更改http端口" aria-hidden="true" class="header-anchor">#</a> 78.3更改HTTP端口</h3> <p>在独立应用程序中，主HTTP端口默认为8080，但可以使用server.port设置（例如，在application.properties中或作为System属性）。 由于轻松绑定了Environment值，您还可以使用SERVER_PORT（例如，作为OS环境变量）。</p> <p>要完全关闭HTTP端点但仍创建WebApplicationContext，请使用server.port = -1。 （这样做有时对测试很有用。）</p> <p>有关更多详细信息，请参阅“Spring Boot features”部分中的“第29.4.4节”“自定义嵌入式Servlet容器”或ServerProperties源代码。</p> <h3 id="_78-4使用随机未分配的http端口"><a href="#_78-4使用随机未分配的http端口" aria-hidden="true" class="header-anchor">#</a> 78.4使用随机未分配的HTTP端口</h3> <p>要扫描空闲端口（使用OS本机来防止冲突），请使用server.port = 0。</p> <h3 id="_78-5在运行时发现http端口"><a href="#_78-5在运行时发现http端口" aria-hidden="true" class="header-anchor">#</a> 78.5在运行时发现HTTP端口</h3> <p>您可以从日志输出访问服务器运行的端口，也可以通过其WebServer访问ServletWebServerApplicationContext。 获得它并确保它已被初始化的最好方法是添加一个类型为ApplicationListener <code>&lt;ServletWebServerInitializedEvent&gt;</code>的@Bean，并在发布时将容器拉出事件。</p> <p>使用@SpringBootTest（webEnvironment = WebEnvironment.RANDOM_PORT）的测试也可以使用@LocalServerPort批注将实际端口注入字段，如以下示例所示：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringJUnit4ClassRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootTest</span><span class="token punctuation">(</span>webEnvironment<span class="token operator">=</span><span class="token class-name">WebEnvironment</span><span class="token punctuation">.</span>RANDOM_PORT<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyWebIntegrationTests</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Autowired</span>
	<span class="token class-name">ServletWebServerApplicationContext</span> server<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@LocalServerPort</span>
	<span class="token keyword">int</span> port<span class="token punctuation">;</span>

	<span class="token comment">// ...</span>

<span class="token punctuation">}</span>
</code></pre></div><p>@LocalServerPort是@Value（“$ {local.server.port}”）的元注释。 不要尝试在常规应用程序中注入端口。 正如我们刚刚看到的那样，只有在容器初始化之后才设置该值。 与测试相反，应用程序代码回调会尽早处理（在值实际可用之前）。</p> <h3 id="_78-6启用http响应压缩"><a href="#_78-6启用http响应压缩" aria-hidden="true" class="header-anchor">#</a> 78.6启用HTTP响应压缩</h3> <p>Jetty，Tomcat和Undertow支持HTTP响应压缩。 它可以在application.properties中启用，如下所示：</p> <div class="language- extra-class"><pre class="language-text"><code>server.compression.enabled=true
</code></pre></div><p>默认情况下，响应必须至少为2048字节，才能执行压缩。 您可以通过设置server.compression.min-response-size属性来配置此行为。</p> <p>默认情况下，只有在内容类型为以下内容之一时才会压缩响应：</p> <ul><li><code>text/html</code></li> <li><code>text/xml</code></li> <li><code>text/plain</code></li> <li><code>text/css</code></li> <li><code>text/javascript</code></li> <li><code>application/javascript</code></li> <li><code>application/json</code></li> <li><code>application/xml</code></li></ul> <p>您可以通过设置server.compression.mime-types属性来配置此行为。</p> <h3 id="_78-7配置ssl"><a href="#_78-7配置ssl" aria-hidden="true" class="header-anchor">#</a> 78.7配置SSL</h3> <p>可以通过设置各种server.ssl.*属性以声明方式配置SSL，通常在application.properties或application.yml中。 以下示例显示了在application.properties中设置SSL属性：</p> <div class="language- extra-class"><pre class="language-text"><code>server.port=8443
server.ssl.key-store=classpath:keystore.jks
server.ssl.key-store-password=secret
server.ssl.key-password=another-secret
</code></pre></div><p>有关所有受支持属性的详细信息，请参阅Ssl。</p> <p>使用上述示例之类的配置意味着应用程序不再支持端口8080上的普通HTTP连接器.Spring Boot不支持通过application.properties配置HTTP连接器和HTTPS连接器。 如果要同时使用两者，则需要以编程方式配置其中一个。 我们建议使用application.properties来配置HTTPS，因为HTTP连接器更容易以编程方式配置。 有关示例，请参阅spring-boot-sample-tomcat-multi-connectors示例项目。</p> <h3 id="_78-8配置http-2"><a href="#_78-8配置http-2" aria-hidden="true" class="header-anchor">#</a> 78.8配置HTTP / 2</h3> <p>您可以使用server.http2.enabled配置属性在Spring Boot应用程序中启用HTTP / 2支持。 此支持取决于所选的Web服务器和应用程序环境，因为JDK8不支持该协议。</p> <blockquote><p>Spring Boot不支持h2c，即HTTP / 2协议的明文版本。 因此，您必须先配置SSL。</p></blockquote> <h4 id="_78-8-1带有undertow的http-2"><a href="#_78-8-1带有undertow的http-2" aria-hidden="true" class="header-anchor">#</a> 78.8.1带有Undertow的HTTP / 2</h4> <p>从Undertow 1.4.0+开始，支持HTTP / 2，对JDK8没有任何额外要求。</p> <h4 id="_78-8-2带jetty的http-2"><a href="#_78-8-2带jetty的http-2" aria-hidden="true" class="header-anchor">#</a> 78.8.2带Jetty的HTTP / 2</h4> <p>从Jetty 9.4.8开始，Conscrypt库也支持HTTP / 2。 要启用该支持，您的应用程序需要有两个额外的依赖项：org.eclipse.jetty：jetty-alpn-conscrypt-server和org.eclipse.jetty.http2：http2-server。</p> <h4 id="_78-8-3使用tomcat的http-2"><a href="#_78-8-3使用tomcat的http-2" aria-hidden="true" class="header-anchor">#</a> 78.8.3使用Tomcat的HTTP / 2</h4> <p>Spring Boot默认使用Tomcat 9.0.x，它在使用JDK 9或更高版本时支持HTTP / 2开箱即用。 或者，如果在主机操作系统上安装了libtcnative库及其依赖项，则可以在JDK 8上使用HTTP / 2。</p> <p>必须使库文件夹（如果尚未可用）到JVM库路径。 您可以使用JVM参数执行此操作，例如-Djava.library.path = / usr / local / opt / tomcat-native / lib。 有关Tomcat官方文档的更多信息。</p> <p>在没有该本机支持的情况下在JDK 8上启动Tomcat 9.0.x会记录以下错误：</p> <div class="language- extra-class"><pre class="language-text"><code>ERROR 8787 --- [           main] o.a.coyote.http11.Http11NioProtocol      : The upgrade handler [org.apache.coyote.http2.Http2Protocol] for [h2] only supports upgrade via ALPN but has been configured for the [&quot;https-jsse-nio-8443&quot;] connector that does not support ALPN.
</code></pre></div><p>这个错误不是致命的，应用程序仍然以HTTP/1.1 SSL支持启动。</p> <h4 id="_78-8-4带有reactor-netty的http-2"><a href="#_78-8-4带有reactor-netty的http-2" aria-hidden="true" class="header-anchor">#</a> 78.8.4带有Reactor Netty的HTTP / 2</h4> <p>spring-boot-webflux-starter默认使用Reactor Netty作为服务器。 可以使用JDK 9或更高版本的JDK支持为Reactor Netty配置HTTP / 2。 对于JDK 8环境或最佳运行时性能，此服务器还支持具有本机库的HTTP / 2。 要启用它，您的应用程序需要具有其他依赖项。</p> <p>Spring Boot管理io.netty的版本：netty-tcnative-boringssl-static“uber jar”，包含适用于所有平台的本机库。 开发人员可以选择使用分类器仅导入所需的依赖项（请参阅Netty官方文档）。</p> <h3 id="_78-9配置web服务器"><a href="#_78-9配置web服务器" aria-hidden="true" class="header-anchor">#</a> 78.9配置Web服务器</h3> <p>通常，您应首先考虑使用众多可用配置键中的一个，并通过在application.properties（或application.yml或环境等）中添加新条目来自定义Web服务器，请参阅“第77.8节”，“发现内置选项”对于外部属性“”）。 server。* namespace在这里非常有用，它包括server.tomcat。*，server.jetty。*等名称空间，用于特定于服务器的功能。请参阅附录A，常见应用程序属性列表。</p> <p>前面的部分介绍了许多常见用例，例如压缩，SSL或HTTP / 2。但是，如果您的用例不存在配置键，则应该查看WebServerFactoryCustomizer。您可以声明这样的组件并获得与您选择的服务器工厂相关的访问权限：您应该为所选服务器（Tomcat，Jetty，Reactor Netty，Undertow）和所选Web堆栈（Servlet或Reactive）选择变体。</p> <p>以下示例适用于具有spring-boot-starter-web（Servlet堆栈）的Tomcat：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyTomcatWebServerCustomizer</span>
		<span class="token keyword">implements</span> <span class="token class-name">WebServerFactoryCustomizer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TomcatServletWebServerFactory</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">customize</span><span class="token punctuation">(</span><span class="token class-name">TomcatServletWebServerFactory</span> factory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// customize the factory here</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>此外，Spring Boot还提供:</strong></p> <table><thead><tr><th>Server</th> <th>Servlet stack</th> <th>Reactive stack</th></tr></thead> <tbody><tr><td>Tomcat</td> <td><code>TomcatServletWebServerFactory</code></td> <td><code>TomcatReactiveWebServerFactory</code></td></tr> <tr><td>Jetty</td> <td><code>JettyServletWebServerFactory</code></td> <td><code>JettyReactiveWebServerFactory</code></td></tr> <tr><td>Undertow</td> <td><code>UndertowServletWebServerFactory</code></td> <td><code>UndertowReactiveWebServerFactory</code></td></tr> <tr><td>Reactor</td> <td>N/A</td> <td><code>NettyReactiveWebServerFactory</code></td></tr></tbody></table> <p>一旦您有权访问WebServerFactory，您通常可以向其添加定制器以配置特定部件，如连接器，服务器资源或服务器本身 - 所有这些都使用特定于服务器的API。</p> <p>作为最后的手段，您还可以声明自己的WebServerFactory组件，它将覆盖Spring Boot提供的组件。 在这种情况下，您不能再依赖服务器命名空间中的配置属性。</p> <h3 id="_78-10向应用程序添加servlet，过滤器或监听器"><a href="#_78-10向应用程序添加servlet，过滤器或监听器" aria-hidden="true" class="header-anchor">#</a> 78.10向应用程序添加Servlet，过滤器或监听器</h3> <p>在servlet堆栈应用程序中，即使用spring-boot-starter-web，有两种方法可以将Servlet API，Filter，ServletContextListener和Servlet API支持的其他侦听器添加到您的应用程序中：</p> <ul><li><a href="https://docs.spring.io/spring-boot/docs/2.1.3.RELEASE/reference/htmlsingle/#howto-add-a-servlet-filter-or-listener-as-spring-bean" target="_blank" rel="noopener noreferrer">Section 78.10.1, “Add a Servlet, Filter, or Listener by Using a Spring Bean”<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://docs.spring.io/spring-boot/docs/2.1.3.RELEASE/reference/htmlsingle/#howto-add-a-servlet-filter-or-listener-using-scanning" target="_blank" rel="noopener noreferrer">Section 78.10.2, “Add Servlets, Filters, and Listeners by Using Classpath Scanning”<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h4 id="_78-10-1使用spring-bean添加servlet，过滤器或监听器"><a href="#_78-10-1使用spring-bean添加servlet，过滤器或监听器" aria-hidden="true" class="header-anchor">#</a> 78.10.1使用Spring Bean添加Servlet，过滤器或监听器</h4> <p>要使用Spring bean添加Servlet，Filter或Servlet * Listener，必须为其提供@Bean定义。 当您想要注入配置或依赖项时，这样做非常有用。 但是，您必须非常小心，它们不会导致太多其他bean的初始化，因为它们必须在应用程序生命周期的早期安装在容器中。 （例如，让它们依赖于您的DataSource或JPA配置并不是一个好主意。）您可以通过在首次使用而不是初始化时懒惰地初始化bean来解决此类限制。</p> <p>对于Filters和Servlet，您还可以通过添加FilterRegistrationBean或ServletRegistrationBean来代替底层组件或添加底层组件来添加映射和init参数。</p> <blockquote><p>如果过滤器注册上没有指定dispatcherType，则使用REQUEST。这符合Servlet规范的默认dispatcher类型。</p></blockquote> <p>像任何其他Spring bean一样，您可以定义Servlet过滤器bean的顺序; 请务必检查“名为”将Servlet，过滤器和监听器注册为Spring Beans“部分。</p> <p><strong>禁用Servlet或过滤器的注册</strong>
如前所述，任何Servlet或Filter bean都会自动注册到servlet容器。 要禁用特定Filter或Servlet bean的注册，请为其创建注册Bean并将其标记为已禁用，如以下示例所示：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">FilterRegistrationBean</span> <span class="token function">registration</span><span class="token punctuation">(</span><span class="token class-name">MyFilter</span> filter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">FilterRegistrationBean</span> registration <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FilterRegistrationBean</span><span class="token punctuation">(</span>filter<span class="token punctuation">)</span><span class="token punctuation">;</span>
	registration<span class="token punctuation">.</span><span class="token function">setEnabled</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> registration<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_78-10-2使用类路径扫描添加servlet，过滤器和监听器"><a href="#_78-10-2使用类路径扫描添加servlet，过滤器和监听器" aria-hidden="true" class="header-anchor">#</a> 78.10.2使用类路径扫描添加Servlet，过滤器和监听器</h4> <p>通过使用@ServletComponentScan注释@Configuration类并指定包含要注册的组件的包，可以使用嵌入式servlet容器自动注册@WebServlet，@ WebFilter和@WebListener注释类。 默认情况下，@ ServletComponentScan会从带注释的类的包中进行扫描。</p> <h3 id="_78-11配置访问日志记录"><a href="#_78-11配置访问日志记录" aria-hidden="true" class="header-anchor">#</a> 78.11配置访问日志记录</h3> <p>可以通过各自的命名空间为Tomcat，Undertow和Jetty配置访问日志。</p> <p>例如，以下设置使用自定义模式在Tomcat上记录访问权限。</p> <div class="language- extra-class"><pre class="language-text"><code>server.tomcat.basedir=my-tomcat
server.tomcat.accesslog.enabled=true
server.tomcat.accesslog.pattern=%t %a &quot;%r&quot; %s (%D ms)
</code></pre></div><blockquote><p>日志的默认位置是一个相对于Tomcat基本目录的日志目录。默认情况下，logs目录是一个临时目录，因此您可能希望修复Tomcat的基本目录，或者为日志使用一个绝对路径。在前面的示例中，可以在my-tomcat/logs中找到与应用程序工作目录相关的日志。</p></blockquote> <p>可以以类似的方式配置Undertow的访问日志记录，如以下示例所示：</p> <div class="language- extra-class"><pre class="language-text"><code>server.undertow.accesslog.enabled=true
server.undertow.accesslog.pattern=%t %a &quot;%r&quot; %s (%D ms)
</code></pre></div><p>日志存储在相对于应用程序工作目录的日志目录中。 您可以通过设置server.undertow.accesslog.directory属性来自定义此位置。</p> <p>最后，Jetty的访问日志记录也可以配置如下：</p> <div class="language- extra-class"><pre class="language-text"><code>server.jetty.accesslog.enabled=true
server.jetty.accesslog.filename=/var/log/jetty-access.log
</code></pre></div><p>默认情况下，日志会重定向到System.err。 有关更多详细信息，请参阅Jetty文档。</p> <h3 id="_78-12在前端代理服务器后面运行"><a href="#_78-12在前端代理服务器后面运行" aria-hidden="true" class="header-anchor">#</a> 78.12在前端代理服务器后面运行</h3> <p>您的应用程序可能需要发送302重定向或使用绝对链接将内容呈现回自身。 在代理后面运行时，调用者需要指向代理的链接，而不是托管应用程序的计算机的物理地址。 通常，这种情况是通过与代理的合同来处理的，代理会添加标题以告诉后端如何构建自己的链接。</p> <p>如果代理添加了传统的X-Forwarded-For和X-Forwarded-Proto标头（大多数代理服务器都这样做），那么绝对链接应该正确呈现，只要在application.properties中将server.use-forward-headers设置为true即可。</p> <blockquote><p>如果您的应用程序在Cloud Foundry或Heroku中运行，则server.use-forward-headers属性默认为true。 在所有其他实例中，它默认为false。</p></blockquote> <h4 id="_78-12-1自定义tomcat的代理配置"><a href="#_78-12-1自定义tomcat的代理配置" aria-hidden="true" class="header-anchor">#</a> 78.12.1自定义Tomcat的代理配置</h4> <p>如果使用Tomcat，还可以配置用于携带“转发”信息的标头名称，如以下示例所示：</p> <div class="language- extra-class"><pre class="language-text"><code>server.tomcat.remote-ip-header=x-your-remote-ip-header
server.tomcat.protocol-header=x-your-protocol-header
</code></pre></div><p>Tomcat还配置了一个默认的正则表达式，该表达式匹配要信任的内部代理。 默认情况下，10 / 8,192.168 / 16,169.254 / 16和127/8中的IP地址是可信的。 您可以通过向application.properties添加条目来自定义阀门的配置，如以下示例所示：</p> <div class="language- extra-class"><pre class="language-text"><code>server.tomcat.internal-proxies=192\\.168\\.\\d{1,3}\\.\\d{1,3}
</code></pre></div><blockquote><p>仅当使用属性文件进行配置时，才需要双反斜杠。 如果使用YAML，则单个反斜杠就足够了，并且与前面示例中显示的值相等的值为192 \ .168 .\ d {1,3} .\ d {1,3}。</p></blockquote> <blockquote><p>您可以通过将internal-proxies设置为空来信任所有代理（但在生产中不这样做）。</p></blockquote> <p>您可以通过关闭自动关闭（执行此操作，设置server.use-forward-headers = false）并在TomcatServletWebServerFactory bean中添加新的阀门实例来完全控制Tomcat的RemoteIpValve的配置。</p> <h3 id="_78-13使用tomcat启用多个连接器"><a href="#_78-13使用tomcat启用多个连接器" aria-hidden="true" class="header-anchor">#</a> 78.13使用Tomcat启用多个连接器</h3> <p>您可以将org.apache.catalina.connector.Connector添加到TomcatServletWebServerFactory，它可以允许多个连接器，包括HTTP和HTTPS连接器，如以下示例所示：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">ServletWebServerFactory</span> <span class="token function">servletContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">TomcatServletWebServerFactory</span> tomcat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TomcatServletWebServerFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	tomcat<span class="token punctuation">.</span><span class="token function">addAdditionalTomcatConnectors</span><span class="token punctuation">(</span><span class="token function">createSslConnector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> tomcat<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token class-name">Connector</span> <span class="token function">createSslConnector</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">Connector</span> connector <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Connector</span><span class="token punctuation">(</span><span class="token string">&quot;org.apache.coyote.http11.Http11NioProtocol&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">Http11NioProtocol</span> protocol <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Http11NioProtocol</span><span class="token punctuation">)</span> connector<span class="token punctuation">.</span><span class="token function">getProtocolHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">try</span> <span class="token punctuation">{</span>
		<span class="token class-name">File</span> keystore <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span><span class="token string">&quot;keystore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">File</span> truststore <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span><span class="token string">&quot;keystore&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		connector<span class="token punctuation">.</span><span class="token function">setScheme</span><span class="token punctuation">(</span><span class="token string">&quot;https&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		connector<span class="token punctuation">.</span><span class="token function">setSecure</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		connector<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">8443</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		protocol<span class="token punctuation">.</span><span class="token function">setSSLEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		protocol<span class="token punctuation">.</span><span class="token function">setKeystoreFile</span><span class="token punctuation">(</span>keystore<span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		protocol<span class="token punctuation">.</span><span class="token function">setKeystorePass</span><span class="token punctuation">(</span><span class="token string">&quot;changeit&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		protocol<span class="token punctuation">.</span><span class="token function">setTruststoreFile</span><span class="token punctuation">(</span>truststore<span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		protocol<span class="token punctuation">.</span><span class="token function">setTruststorePass</span><span class="token punctuation">(</span><span class="token string">&quot;changeit&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		protocol<span class="token punctuation">.</span><span class="token function">setKeyAlias</span><span class="token punctuation">(</span><span class="token string">&quot;apitester&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> connector<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">&quot;can't access keystore: [&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;keystore&quot;</span>
				<span class="token operator">+</span> <span class="token string">&quot;] or truststore: [&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;keystore&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">,</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_78-14使用tomcat的legacycookieprocessor"><a href="#_78-14使用tomcat的legacycookieprocessor" aria-hidden="true" class="header-anchor">#</a> 78.14使用Tomcat的LegacyCookieProcessor</h3> <p>默认情况下，Spring Boot使用的嵌入式Tomcat不支持Cookie格式的“Version 0”，因此您可能会看到以下错误：</p> <div class="language- extra-class"><pre class="language-text"><code>java.lang.IllegalArgumentException: An invalid character [32] was present in the Cookie value
</code></pre></div><p>如果可能的话，您应该考虑将代码更新为仅存储符合以后Cookie规范的值。 但是，如果您无法更改cookie的编写方式，则可以将Tomcat配置为使用LegacyCookieProcessor。 要切换到LegacyCookieProcessor，请使用添加TomcatContextCustomizer的WebServerFactoryCustomizer bean，如以下示例所示：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">WebServerFactoryCustomizer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TomcatServletWebServerFactory</span><span class="token punctuation">&gt;</span></span> <span class="token function">cookieProcessorCustomizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span>factory<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> factory<span class="token punctuation">.</span><span class="token function">addContextCustomizers</span><span class="token punctuation">(</span>
			<span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> context<span class="token punctuation">.</span><span class="token function">setCookieProcessor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LegacyCookieProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_78-15使用undertow启用多个侦听器"><a href="#_78-15使用undertow启用多个侦听器" aria-hidden="true" class="header-anchor">#</a> 78.15使用Undertow启用多个侦听器</h3> <p>将UndertowBuilderCustomizer添加到UndertowServletWebServerFactory并向Builder添加一个侦听器，如以下示例所示：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">UndertowServletWebServerFactory</span> <span class="token function">servletWebServerFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">UndertowServletWebServerFactory</span> factory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UndertowServletWebServerFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	factory<span class="token punctuation">.</span><span class="token function">addBuilderCustomizers</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UndertowBuilderCustomizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

		<span class="token annotation punctuation">@Override</span>
		<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">customize</span><span class="token punctuation">(</span><span class="token class-name">Builder</span> builder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			builder<span class="token punctuation">.</span><span class="token function">addHttpListener</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">,</span> <span class="token string">&quot;0.0.0.0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> factory<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_78-16使用-serverendpoint创建websocket端点"><a href="#_78-16使用-serverendpoint创建websocket端点" aria-hidden="true" class="header-anchor">#</a> 78.16使用@ServerEndpoint创建WebSocket端点</h3> <p>如果要在使用嵌入式容器的Spring Boot应用程序中使用@ServerEndpoint，则必须声明单个ServerEndpointExporter @Bean，如以下示例所示：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">ServerEndpointExporter</span> <span class="token function">serverEndpointExporter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ServerEndpointExporter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>前面示例中显示的bean使用基础WebSocket容器注册任何带有@ServerEndpoint注释的bean。 当部署到独立的servlet容器时，此角色由servlet容器初始化程序执行，而不需要ServerEndpointExporter bean。</p> <h2 id="_79-spring-mvc"><a href="#_79-spring-mvc" aria-hidden="true" class="header-anchor">#</a> 79.Spring MVC</h2> <p>Spring Boot有许多包含Spring MVC的启动器。 请注意，一些启动器包含对Spring MVC的依赖，而不是直接包含它。 本节回答有关Spring MVC和Spring Boot的常见问题。</p> <h3 id="_79-1编写json-rest服务"><a href="#_79-1编写json-rest服务" aria-hidden="true" class="header-anchor">#</a> 79.1编写JSON REST服务</h3> <p>只要Jackson2在类路径中，Spring Boot应用程序中的任何Spring @RestController都应默认呈现JSON响应，如以下示例所示：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyController</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/thing&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">MyThing</span> <span class="token function">thing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>只要MyThing可以被Jackson2序列化（对于普通的POJO或Groovy对象都是如此），那么localhost：8080 / thing默认提供它的JSON表示。 请注意，在浏览器中，您有时可能会看到XML响应，因为浏览器倾向于发送更喜欢XML的接受标头。</p> <h3 id="_79-2编写xml-rest服务"><a href="#_79-2编写xml-rest服务" aria-hidden="true" class="header-anchor">#</a> 79.2编写XML REST服务</h3> <p>如果在类路径上有Jackson XML扩展（jackson-dataformat-xml），则可以使用它来呈现XML响应。 我们用于JSON的前一个示例可以使用。 要使用Jackson XML渲染器，请将以下依赖项添加到项目中：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;dependency&gt;
	&lt;groupId&gt;com.fasterxml.jackson.dataformat&lt;/groupId&gt;
	&lt;artifactId&gt;jackson-dataformat-xml&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre></div><p>如果Jackson的XML扩展不可用，则使用JAXB（默认情况下在JDK中提供），并且需要将MyThing注释为@XmlRootElement，如以下示例所示：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@XmlRootElement</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThing</span> <span class="token punctuation">{</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
	<span class="token comment">// .. getters and setters</span>
<span class="token punctuation">}</span>
</code></pre></div><p>要使服务器呈现XML而不是JSON，您可能必须发送Accept：text / xml标头（或使用浏览器）。</p> <h3 id="_79-3自定义jackson-objectmapper"><a href="#_79-3自定义jackson-objectmapper" aria-hidden="true" class="header-anchor">#</a> 79.3自定义Jackson ObjectMapper</h3> <p>Spring MVC（客户端和服务器端）使用HttpMessageConverters在HTTP交换中协商内容转换。如果Jackson在类路径上，您已经获得了Jackson2ObjectMapperBuilder提供的默认转换器，其中一个实例是为您自动配置的。</p> <p>ObjectMapper（或Jackson XML转换器的XmlMapper）实例（默认创建）具有以下自定义属性：</p> <ul><li>MapperFeature.DEFAULT_VIEW_INCLUSION已禁用</li> <li>DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES已禁用</li> <li>SerializationFeature.WRITE_DATES_AS_TIMESTAMPS已禁用</li></ul> <p>Spring Boot还具有一些功能，可以更轻松地自定义此行为。</p> <p>您可以使用环境配置ObjectMapper和XmlMapper实例。 Jackson提供了一套广泛的简单开/关功能，可用于配置其处理的各个方面。这些功能在六个enum（在Jackson中）中描述，它们映射到环境中的属性：</p> <table><thead><tr><th>Enum</th> <th>Property</th> <th>Values</th></tr></thead> <tbody><tr><td><code>com.fasterxml.jackson.databind.DeserializationFeature</code></td> <td><code>spring.jackson.deserialization.&lt;feature_name&gt;</code></td> <td><code>true</code>, <code>false</code></td></tr> <tr><td><code>com.fasterxml.jackson.core.JsonGenerator.Feature</code></td> <td><code>spring.jackson.generator.&lt;feature_name&gt;</code></td> <td><code>true</code>, <code>false</code></td></tr> <tr><td><code>com.fasterxml.jackson.databind.MapperFeature</code></td> <td><code>spring.jackson.mapper.&lt;feature_name&gt;</code></td> <td><code>true</code>, <code>false</code></td></tr> <tr><td><code>com.fasterxml.jackson.core.JsonParser.Feature</code></td> <td><code>spring.jackson.parser.&lt;feature_name&gt;</code></td> <td><code>true</code>, <code>false</code></td></tr> <tr><td><code>com.fasterxml.jackson.databind.SerializationFeature</code></td> <td><code>spring.jackson.serialization.&lt;feature_name&gt;</code></td> <td><code>true</code>, <code>false</code></td></tr> <tr><td><code>com.fasterxml.jackson.annotation.JsonInclude.Include</code></td> <td><code>spring.jackson.default-property-inclusion</code></td> <td><code>always</code>, <code>non_null</code>, <code>non_absent</code>, <code>non_default</code>, <code>non_empty</code></td></tr></tbody></table> <p>例如，要启用漂亮打印，请设置spring.jackson.serialization.indent_output = true。请注意，由于使用了宽松绑定，indent_output的情况不必与相应的枚举常量（即INDENT_OUTPUT）的情况相匹配。</p> <p>此基于环境的配置应用于自动配置的Jackson2ObjectMapperBuilder bean，并应用于使用构建器创建的任何映射器，包括自动配置的ObjectMapper bean。</p> <p>上下文的Jackson2ObjectMapperBuilder可以由一个或多个Jackson2ObjectMapperBuilderCustomizer bean定制。可以订购这样的定制器bean（Boot自己的定制器的顺序为0），允许在Boot定制之前和之后应用其他定制。</p> <p>任何类型为com.fasterxml.jackson.databind.Module的bean都会自动注册到自动配置的Jackson2ObjectMapperBuilder，并应用于它创建的任何ObjectMapper实例。这为您在应用程序中添加新功能时提供了一种提供自定义模块的全局机制。</p> <p>如果要完全替换默认的ObjectMapper，请定义该类型的@Bean并将其标记为@Primary，或者，如果您更喜欢基于构建器的方法，请定义Jackson2ObjectMapperBuilder @Bean。请注意，在任何一种情况下，这样做都会禁用ObjectMapper的所有自动配置。</p> <p>如果您提供任何类型为MappingJackson2HttpMessageConverter的@Beans，它们将替换MVC配置中的默认值。此外，还提供了类型为HttpMessageConverters的便捷bean（如果使用默认的MVC配置，则始终可用）。它有一些有用的方法来访问默认和用户增强的消息转换器。</p> <p>有关更多详细信息，请参见“79.4节”，“自定义@ResponseBody渲染”部分和WebMvcAutoConfiguration源代码。</p> <h3 id="_79-4自定义-responsebody渲染"><a href="#_79-4自定义-responsebody渲染" aria-hidden="true" class="header-anchor">#</a> 79.4自定义@ResponseBody渲染</h3> <p>Spring使用HttpMessageConverters呈现@ResponseBody（或来自@RestController的响应）。您可以通过在Spring Boot上下文中添加适当类型的bean来提供其他转换器。如果您添加的bean是默认包含的类型（例如，用于JSON转换的MappingJackson2HttpMessageConverter），它将替换默认值。提供了类型为HttpMessageConverters的便捷bean，如果您使用默认的MVC配置，它始终可用。它有一些有用的方法来访问默认和用户增强的消息转换器（例如，如果要将它们手动注入自定义RestTemplate，它可能很有用）。</p> <p>与正常的MVC用法一样，您提供的任何WebMvcConfigurer bean也可以通过覆盖configureMessageConverters方法来提供转换器。但是，与普通的MVC不同，您只能提供所需的其他转换器（因为Spring Boot使用相同的机制来提供其默认值）。最后，如果您通过提供自己的@EnableWebMvc配置选择退出Spring Boot默认MVC配置，则可以完全控制并通过使用WebMvcConfigurationSupport中的getMessageConverters手动完成所有操作。</p> <p>有关更多详细信息，请参阅WebMvcAutoConfiguration源代码。</p> <h3 id="_79-5处理多部分文件上载"><a href="#_79-5处理多部分文件上载" aria-hidden="true" class="header-anchor">#</a> 79.5处理多部分文件上载</h3> <p>Spring Boot包含Servlet 3 javax.servlet.http.Part API以支持上传文件。 默认情况下，Spring Boot配置Spring MVC，每个文件的最大大小为1MB，单个请求中的文件数据最大为10MB。 您可以覆盖这些值，中间数据的存储位置（例如，到/ tmp目录），以及使用MultipartProperties类中公开的属性将数据刷新到磁盘的阈值。 例如，如果要指定文件不受限制，请将spring.servlet.multipart.max-file-size属性设置为-1。</p> <p>当您希望在Spring MVC控制器处理程序方法中将多部分编码的文件数据作为MultipartFile类型的@RequestParam注释参数接收时，多部分支持非常有用。</p> <p>有关更多详细信息，请参阅MultipartAutoConfiguration源。</p> <blockquote><p>建议使用容器的内置支持进行分段上传，而不是引入其他依赖项，例如Apache Commons File Upload。</p></blockquote> <h3 id="_79-6关闭spring-mvc-dispatcherservlet"><a href="#_79-6关闭spring-mvc-dispatcherservlet" aria-hidden="true" class="header-anchor">#</a> 79.6关闭Spring MVC DispatcherServlet</h3> <p>默认情况下，所有内容都是从应用程序的根目录（/）提供的。 如果您希望映射到其他路径，可以按如下方式配置：</p> <div class="language- extra-class"><pre class="language-text"><code>spring.mvc.servlet.path=/acme
</code></pre></div><p>如果你有额外的servlet，你可以为每个servlet声明一个类型为Servlet或ServletRegistrationBean的@Bean，Spring Boot会将它们透明地注册到容器中。 因为servlet是以这种方式注册的，所以可以将它们映射到DispatcherServlet的子上下文而不调用它。</p> <p>自己配置DispatcherServlet是不寻常的，但如果你真的需要这样做，还必须提供类型为DispatcherServletPath的@Bean，以提供自定义DispatcherServlet的路径。</p> <h3 id="_79-7关闭默认mvc配置"><a href="#_79-7关闭默认mvc配置" aria-hidden="true" class="header-anchor">#</a> 79.7关闭默认MVC配置</h3> <p>完全控制MVC配置的最简单方法是使用@EnableWebMvc注释提供您自己的@Configuration。 这样做会将所有MVC配置留在您的手中。</p> <h3 id="_79-8自定义viewresolvers"><a href="#_79-8自定义viewresolvers" aria-hidden="true" class="header-anchor">#</a> 79.8自定义ViewResolvers</h3> <p>ViewResolver是Spring MVC的核心组件，将@Controller中的视图名称转换为实际的View实现。 请注意，ViewResolvers主要用于UI应用程序，而不是REST样式的服务（View不用于呈现@ResponseBody）。 ViewResolver有很多可供选择的实现，而Spring本身并不认为你应该使用哪些。 另一方面，Spring Boot会为您安装一个或两个，具体取决于它在类路径和应用程序上下文中找到的内容。 DispatcherServlet使用它在应用程序上下文中找到的所有解析器，依次尝试每个解析器，直到得到结果，因此，如果添加自己的解析器，则必须知道顺序以及添加解析器的位置。</p> <p>WebMvcAutoConfiguration将以下ViewResolvers添加到您的上下文中：</p> <ul><li>一个名为“defaultViewResolver”的InternalResourceViewResolver。 这个定位可以使用DefaultServlet呈现的物理资源（包括静态资源和JSP页面，如果您使用它们）。 它将前缀和后缀应用于视图名称，然后在servlet上下文中查找具有该路径的物理资源（默认值为空，但可通过spring.mvc.view.prefix和spring.mvc进行外部配置。view.suffix）。 您可以通过提供相同类型的bean来覆盖它。</li> <li>名为“beanNameViewResolver”的BeanNameViewResolver。 这是视图解析器链的一个有用成员，并获取与正在解析的视图同名的任何bean。 没有必要覆盖或替换它。</li> <li>仅当存在View类型的Bean时，才会添加名为“viewResolver”的ContentNegotiatingViewResolver。 这是一个“主”解析器，委托给所有其他人，并尝试找到客户端发送的“Accept”HTTP标头的匹配项。 有一个关于ContentNegotiatingViewResolver的有用博客，您可能希望学习以了解更多信息，您也可以查看源代码以获取详细信息。 您可以通过定义名为“viewResolver”的bean来关闭自动配置的ContentNegotiatingViewResolver。</li> <li>如果您使用Thymeleaf，您还有一个名为'thymeleafViewResolver'的ThymeleafViewResolver。 它通过使用前缀和后缀包围视图名称来查找资源。 前缀是spring.thymeleaf.prefix，后缀是spring.thymeleaf.suffix。 前缀和后缀的值分别默认为“classpath：/ templates /”和“.html”。 您可以通过提供相同名称的bean来覆盖ThymeleafViewResolver。</li> <li>如果您使用FreeMarker，您还有一个名为“freeMarkerViewResolver”的FreeMarkerViewResolver。 它通过用前缀和后缀包围视图名称来查找加载器路径中的资源（外部化为spring.freemarker.templateLoaderPath并具有默认值'classpath：/ templates /'）。 前缀外部化为spring.freemarker.prefix，后缀外部化为spring.freemarker.suffix。 前缀和后缀的默认值分别为空和“.ftl”。 您可以通过提供相同名称的bean来覆盖FreeMarkerViewResolver。</li> <li>如果您使用Groovy模板（实际上，如果groovy-templates在您的类路径中），您还有一个名为'groovyMarkupViewResolver'的GroovyMarkupViewResolver。 它通过用前缀和后缀包围视图名称来查找加载器路径中的资源（外部化为spring.groovy.template.prefix和spring.groovy.template.suffix）。 前缀和后缀分别具有“classpath：/ templates /”和“.tpl”的默认值。 您可以通过提供相同名称的bean来覆盖GroovyMarkupViewResolver。</li></ul> <p>有关详情，请参阅以下部分:</p> <ul><li><a href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/servlet/WebMvcAutoConfiguration.java" target="_blank" rel="noopener noreferrer"><code>WebMvcAutoConfiguration</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/thymeleaf/ThymeleafAutoConfiguration.java" target="_blank" rel="noopener noreferrer"><code>ThymeleafAutoConfiguration</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/freemarker/FreeMarkerAutoConfiguration.java" target="_blank" rel="noopener noreferrer"><code>FreeMarkerAutoConfiguration</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/spring-projects/spring-boot/tree/v2.1.3.RELEASE/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/groovy/template/GroovyTemplateAutoConfiguration.java" target="_blank" rel="noopener noreferrer"><code>GroovyTemplateAutoConfiguration</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="_80-使用spring-security进行测试"><a href="#_80-使用spring-security进行测试" aria-hidden="true" class="header-anchor">#</a> 80.使用Spring Security进行测试</h2> <p>Spring Security支持以特定用户身份运行测试。 例如，下面代码段中的测试将与具有ADMIN角色的经过身份验证的用户一起运行。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token annotation punctuation">@WithMockUser</span><span class="token punctuation">(</span>roles<span class="token operator">=</span><span class="token string">&quot;ADMIN&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">requestProtectedUrlWithUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
	mvc
		<span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Spring Security提供了与Spring MVC Test的全面集成，这也可以在使用@WebMvcTest切片和MockMvc测试控制器时使用。</p> <p>有关Spring Security测试支持的其他详细信息，请参阅Spring Security的参考文档）。</p> <h2 id="_81-jersey"><a href="#_81-jersey" aria-hidden="true" class="header-anchor">#</a> 81.Jersey</h2> <h3 id="_81-1使用spring-security保护jersey端点"><a href="#_81-1使用spring-security保护jersey端点" aria-hidden="true" class="header-anchor">#</a> 81.1使用Spring Security保护Jersey端点</h3> <p>Spring Security可用于保护基于Jersey的Web应用程序，其方式与用于保护基于Spring MVC的Web应用程序的方式非常相似。 但是，如果要在Jersey中使用Spring Security的方法级安全性，则必须将Jersey配置为使用setStatus（int）而不是sendError（int）。 这可以防止Jersey在Spring Security有机会向客户端报告身份验证或授权失败之前提交响应。</p> <p>必须在应用程序的ResourceConfig bean上将jersey.config.server.response.setStatusOverSendError属性设置为true，如以下示例所示：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JerseyConfig</span> <span class="token keyword">extends</span> <span class="token class-name">ResourceConfig</span> <span class="token punctuation">{</span>

	<span class="token keyword">public</span> <span class="token class-name">JerseyConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">register</span><span class="token punctuation">(</span><span class="token class-name">Endpoint</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">setProperties</span><span class="token punctuation">(</span><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singletonMap</span><span class="token punctuation">(</span>
				<span class="token string">&quot;jersey.config.server.response.setStatusOverSendError&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h2 id="_82-http客户端"><a href="#_82-http客户端" aria-hidden="true" class="header-anchor">#</a> 82.HTTP客户端</h2> <p>Spring Boot提供了许多与HTTP客户端配合使用的启动器。 本节回答与使用它们相关的问题。</p> <h3 id="_82-1配置resttemplate以使用代理"><a href="#_82-1配置resttemplate以使用代理" aria-hidden="true" class="header-anchor">#</a> 82.1配置RestTemplate以使用代理</h3> <p>如第35.1节“RestTemplate Customization”中所述，您可以将RestTemplateCustomizer与RestTemplateBuilder一起使用来构建自定义的RestTemplate。 这是创建配置为使用代理的RestTemplate的推荐方法。</p> <p>代理配置的确切详细信息取决于正在使用的基础客户端请求工厂。 以下示例使用HttpClient配置HttpComponentsClientRequestFactory，该HttpClient使用除192.168.0.5之外的所有主机的代理：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">ProxyCustomizer</span> <span class="token keyword">implements</span> <span class="token class-name">RestTemplateCustomizer</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">customize</span><span class="token punctuation">(</span><span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">HttpHost</span> proxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">(</span><span class="token string">&quot;proxy.example.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">HttpClient</span> httpClient <span class="token operator">=</span> <span class="token class-name">HttpClientBuilder</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">setRoutePlanner</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DefaultProxyRoutePlanner</span><span class="token punctuation">(</span>proxy<span class="token punctuation">)</span> <span class="token punctuation">{</span>

					<span class="token annotation punctuation">@Override</span>
					<span class="token keyword">public</span> <span class="token class-name">HttpHost</span> <span class="token function">determineProxy</span><span class="token punctuation">(</span><span class="token class-name">HttpHost</span> target<span class="token punctuation">,</span>
							<span class="token class-name">HttpRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpContext</span> context<span class="token punctuation">)</span>
							<span class="token keyword">throws</span> <span class="token class-name">HttpException</span> <span class="token punctuation">{</span>
						<span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">getHostName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;192.168.0.5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
							<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
						<span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">determineProxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> request<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>

				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		restTemplate<span class="token punctuation">.</span><span class="token function">setRequestFactory</span><span class="token punctuation">(</span>
				<span class="token keyword">new</span> <span class="token class-name">HttpComponentsClientHttpRequestFactory</span><span class="token punctuation">(</span>httpClient<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h2 id="_83-logging"><a href="#_83-logging" aria-hidden="true" class="header-anchor">#</a> 83. Logging</h2> <p>除了Commons Logging API之外，Spring Boot没有强制的日志记录依赖性，Commons Logging API通常由Spring Framework的spring-jcl模块提供。 要使用Logback，您需要在类路径中包含它和spring-jcl。 最简单的方法是通过启动器，它们都依赖于spring-boot-starter-logging。 对于Web应用程序，您只需要spring-boot-starter-web，因为它依赖于日志记录启动器。 如果您使用Maven，以下依赖项会为您添加日志记录：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;dependency&gt;
	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
	&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre></div><p>Spring Boot有一个LoggingSystem抽象，它试图根据类路径的内容配置日志记录。 如果Logback可用，则它是第一选择。</p> <p>如果您需要对日志记录进行的唯一更改是设置各种记录器的级别，则可以使用“logging.level”前缀在application.properties中执行此操作，如以下示例所示：</p> <div class="language- extra-class"><pre class="language-text"><code>logging.level.org.springframework.web=DEBUG
logging.level.org.hibernate=ERROR
</code></pre></div><p>您还可以使用“logging.file”设置要写入日志的文件的位置（除控制台外）。</p> <p>要配置日志记录系统的更细粒度设置，您需要使用相关LoggingSystem支持的本机配置格式。 默认情况下，Spring Boot从系统的默认位置（例如classpath：Logback的logback.xml）中选择本机配置，但您可以使用“logging.config”属性设置配置文件的位置。</p> <h3 id="_83-1配置日志记录的日志记录"><a href="#_83-1配置日志记录的日志记录" aria-hidden="true" class="header-anchor">#</a> 83.1配置日志记录的日志记录</h3> <p>如果将logback.xml放在类路径的根目录中，则从那里（或从logback-spring.xml中获取）以利用Boot提供的模板功能。 Spring Boot提供了一个默认的基本配置，如果要设置级别，可以包括该配置，如以下示例所示：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>org/springframework/boot/logging/logback/base.xml<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>org.springframework.web<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>DEBUG<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>如果你看一下spring-boot jar中的base.xml，你会发现它使用了LoggingSystem为你创建的一些有用的System属性：</p> <ul><li><code>${PID}</code>: The current process ID.</li> <li><code>${LOG_FILE}</code>: Whether <code>logging.file</code> was set in Boot’s external configuration.</li> <li><code>${LOG_PATH}</code>: Whether <code>logging.path</code> (representing a directory for log files to live in) was set in Boot’s external configuration.</li> <li><code>${LOG_EXCEPTION_CONVERSION_WORD}</code>: Whether <code>logging.exception-conversion-word</code> was set in Boot’s external configuration.</li></ul> <p>如果Groovy在类路径上，您应该能够使用logback.groovy配置Logback。如果存在，则优先考虑此设置。</p> <h4 id="_83-1-1配置仅文件输出的日志记录"><a href="#_83-1-1配置仅文件输出的日志记录" aria-hidden="true" class="header-anchor">#</a> 83.1.1配置仅文件输出的日志记录</h4> <p>如果要禁用控制台日志记录并仅将输出写入文件，则需要使用自定义logback-spring.xml导入file-appender.xml但不导入console-appender.xml，如以下示例所示：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>org/springframework/boot/logging/logback/defaults.xml<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>LOG_FILE<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>${LOG_FILE:-${LOG_PATH:-${LOG_TEMP:-${java.io.tmpdir:-/tmp}}/}spring.log}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>org/springframework/boot/logging/logback/file-appender.xml<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>INFO<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>FILE<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>您还需要将logging.file添加到application.properties，如以下示例所示：</p> <div class="language- extra-class"><pre class="language-text"><code>logging.file=myapplication.log
</code></pre></div><h3 id="_83-2配置log4j进行日志记录"><a href="#_83-2配置log4j进行日志记录" aria-hidden="true" class="header-anchor">#</a> 83.2配置Log4j进行日志记录</h3> <p>Spring Boot支持Log4j 2进行日志记录配置（如果它在类路径上）。 如果使用启动器来组装依赖项，则必须排除Logback，然后再包含log4j 2。 如果你不使用启动器，除了Log4j 2之外，还需要提供（至少）spring-jcl。</p> <p>最简单的路径可能是通过初学者，即使它需要一些与排除的摇晃。 以下示例显示如何在Maven中设置启动器：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-logging<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-log4j2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>下面的例子展示了在Gradle中设置启动器的一种方法:</p> <div class="language- extra-class"><pre class="language-text"><code>dependencies {
	compile 'org.springframework.boot:spring-boot-starter-web'
	compile 'org.springframework.boot:spring-boot-starter-log4j2'
}

configurations {
	all {
		exclude group: 'org.springframework.boot', module: 'spring-boot-starter-logging'
	}
}
</code></pre></div><blockquote><p>Log4j启动程序将常见日志记录要求的依赖关系聚集在一起（例如让Tomcat使用java.util.logging但使用Log4j 2配置输出）。 有关详细信息，请参阅Actuator Log4j 2示例并查看其实际操作。</p> <p>要确保使用java.util.logging执行的调试日志记录路由到Log4j 2，请通过将java.util.logging.manager系统属性设置为org.apache.logging.log4j.jul.LogManager来配置其JDK日志记录适配器。</p></blockquote> <h4 id="_83-2-1使用yaml或json配置log4j-2"><a href="#_83-2-1使用yaml或json配置log4j-2" aria-hidden="true" class="header-anchor">#</a> 83.2.1使用YAML或JSON配置Log4j 2</h4> <p>除了默认的XML配置格式外，Log4j 2还支持YAML和JSON配置文件。 要将Log4j 2配置为使用备用配置文件格式，请将相应的依赖项添加到类路径，并将配置文件命名为与所选文件格式匹配，如以下示例所示：</p> <table><thead><tr><th>Format</th> <th>Dependencies</th> <th>File names</th></tr></thead> <tbody><tr><td>YAML</td> <td><code>com.fasterxml.jackson.core:jackson-databind``com.fasterxml.jackson.dataformat:jackson-dataformat-yaml</code></td> <td><code>log4j2.yaml``log4j2.yml</code></td></tr> <tr><td>JSON</td> <td><code>com.fasterxml.jackson.core:jackson-databind</code></td> <td><code>log4j2.json``log4j2.jsn</code></td></tr></tbody></table> <h2 id="_84-数据访问"><a href="#_84-数据访问" aria-hidden="true" class="header-anchor">#</a> 84.数据访问</h2> <p>Spring Boot包含许多用于处理数据源的启动器。 本节回答与此相关的问题。</p> <h3 id="_84-1配置自定义数据源"><a href="#_84-1配置自定义数据源" aria-hidden="true" class="header-anchor">#</a> 84.1配置自定义数据源</h3> <p>要配置自己的DataSource，请在配置中定义该类型的@Bean。 Spring Boot在任何需要的地方重用您的DataSource，包括数据库初始化。 如果需要外部化某些设置，可以将DataSource绑定到环境中（请参阅“第24.8.1节”“第三方配置”）。</p> <p>以下示例显示如何在bean中定义数据源：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix<span class="token operator">=</span><span class="token string">&quot;app.datasource&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FancyDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>下面的例子展示了如何通过设置属性来定义数据源:</p> <div class="language- extra-class"><pre class="language-text"><code>app.datasource.url=jdbc:h2:mem:mydb
app.datasource.username=sa
app.datasource.pool-size=30
</code></pre></div><p>假设您的FancyDataSource具有URL的常规JavaBean属性，用户名和池大小，这些设置在DataSource可供其他组件使用之前自动绑定。 常规数据库初始化也会发生（因此spring.datasource。*的相关子集仍可以与您的自定义配置一起使用）。</p> <p>Spring Boot还提供了一个名为DataSourceBuilder的实用程序构建器类，可用于创建其中一个标准数据源（如果它位于类路径中）。 构建器可以根据类路径上的可用内容检测要使用的那个。 它还会根据JDBC URL自动检测驱动程序。</p> <p>以下示例说明如何使用DataSourceBuilder创建数据源：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span><span class="token string">&quot;app.datasource&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token class-name">DataSourceBuilder</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>要使用该DataSource运行应用程序，您只需要连接信息。 还可以提供特定于池的设置。 检查将在运行时使用的实现以获取更多详细信息。</p> <p>以下示例说明如何通过设置属性来定义JDBC数据源：</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token attr-name">app.datasource.url</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://localhost/test</span>
<span class="token attr-name">app.datasource.username</span><span class="token punctuation">=</span><span class="token attr-value">dbuser</span>
<span class="token attr-name">app.datasource.password</span><span class="token punctuation">=</span><span class="token attr-value">dbpass</span>
<span class="token attr-name">app.datasource.pool-size</span><span class="token punctuation">=</span><span class="token attr-value">30</span>
</code></pre></div><p>然而，有一个问题。 由于未公开连接池的实际类型，因此在自定义DataSource的元数据中不会生成任何键，并且IDE中没有可用的完成（因为DataSource接口不公开任何属性）。 此外，如果你碰巧在类路径上有Hikari，这个基本设置不起作用，因为Hikari没有url属性（但是有一个jdbcUrl属性）。 在这种情况下，您必须按如下方式重写配置：</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token attr-name">app.datasource.jdbc-url</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://localhost/test</span>
<span class="token attr-name">app.datasource.username</span><span class="token punctuation">=</span><span class="token attr-value">dbuser</span>
<span class="token attr-name">app.datasource.password</span><span class="token punctuation">=</span><span class="token attr-value">dbpass</span>
<span class="token attr-name">app.datasource.maximum-pool-size</span><span class="token punctuation">=</span><span class="token attr-value">30</span>
</code></pre></div><p>您可以通过强制连接池使用并返回专用实现而不是DataSource来解决此问题。 您无法在运行时更改实现，但选项列表将是显式的。</p> <p>以下示例显示如何使用DataSourceBuilder创建HikariDataSource：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span><span class="token string">&quot;app.datasource&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">HikariDataSource</span> <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token class-name">DataSourceBuilder</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token class-name">HikariDataSource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>您甚至可以通过利用DataSourceProperties为您做的事情来进一步发展 - 也就是说，如果没有提供URL，则通过提供具有合理用户名和密码的默认嵌入式数据库。 您可以从任何DataSourceProperties对象的状态轻松初始化DataSourceBuilder，因此您也可以注入Spring Boot自动创建的DataSource。 但是，这会将您的配置拆分为两个名称空间：spring.datasource上的url，username，password，type和driver，以及自定义名称空间（app.datasource）上的其余名称空间。 为避免这种情况，您可以在自定义命名空间上重新定义自定义DataSourceProperties，如以下示例所示：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@Primary</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span><span class="token string">&quot;app.datasource&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">DataSourceProperties</span> <span class="token function">dataSourceProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DataSourceProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span><span class="token string">&quot;app.datasource.configuration&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">HikariDataSource</span> <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token class-name">DataSourceProperties</span> properties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> properties<span class="token punctuation">.</span><span class="token function">initializeDataSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token class-name">HikariDataSource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>默认情况下，此设置使您与Spring Boot为您执行的操作保持同步，除了选择专用连接池（在代码中）并且其设置在app.datasource.configuration子命名空间中公开。 因为DataSourceProperties正在为您处理url / jdbcUrl转换，所以您可以按如下方式对其进行配置：</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token attr-name">app.datasource.url</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://localhost/test</span>
<span class="token attr-name">app.datasource.username</span><span class="token punctuation">=</span><span class="token attr-value">dbuser</span>
<span class="token attr-name">app.datasource.password</span><span class="token punctuation">=</span><span class="token attr-value">dbpass</span>
<span class="token attr-name">app.datasource.configuration.maximum-pool-size</span><span class="token punctuation">=</span><span class="token attr-value">30</span>
</code></pre></div><blockquote><p>Spring Boot会将Hikari特定的设置暴露给spring.datasource.hikari。 此示例使用更通用的配置子命名空间，因为该示例不支持多个数据源实现。</p> <p>由于您的自定义配置选择使用Hikari，因此app.datasource.type无效。 在实践中，构建器初始化为您可能在那里设置的任何值，然后通过调用.type（）来覆盖。</p></blockquote> <p>有关更多详细信息，请参见“Spring Boot features”部分中的“Section 31.1，”配置DataSource“”和DataSourceAutoConfiguration类。</p> <h3 id="_84-2配置两个数据源"><a href="#_84-2配置两个数据源" aria-hidden="true" class="header-anchor">#</a> 84.2配置两个数据源</h3> <p>如果需要配置多个数据源，可以应用上一节中描述的相同技巧。 但是，您必须将其中一个DataSource实例标记为@Primary，因为随后的各种自动配置希望能够按类型获取。</p> <p>如果您创建自己的DataSource，则自动配置会退回。 在以下示例中，我们提供与主数据源上提供的自动配置完全相同的功能集：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@Primary</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span><span class="token string">&quot;app.datasource.first&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">DataSourceProperties</span> <span class="token function">firstDataSourceProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DataSourceProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@Primary</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span><span class="token string">&quot;app.datasource.first.configuration&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">HikariDataSource</span> <span class="token function">firstDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">firstDataSourceProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">initializeDataSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token class-name">HikariDataSource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span><span class="token string">&quot;app.datasource.second&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">BasicDataSource</span> <span class="token function">secondDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token class-name">DataSourceBuilder</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token class-name">BasicDataSource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>必须将firstDataSourceProperties标记为@Primary，以便数据库初始化程序功能使用您的副本（如果使用初始化程序）。</p></blockquote> <p>这两个数据源也绑定了高级自定义。 例如，您可以按如下方式配置它们：</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token attr-name">app.datasource.first.url</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://localhost/first</span>
<span class="token attr-name">app.datasource.first.username</span><span class="token punctuation">=</span><span class="token attr-value">dbuser</span>
<span class="token attr-name">app.datasource.first.password</span><span class="token punctuation">=</span><span class="token attr-value">dbpass</span>
<span class="token attr-name">app.datasource.first.configuration.maximum-pool-size</span><span class="token punctuation">=</span><span class="token attr-value">30</span>

<span class="token attr-name">app.datasource.second.url</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://localhost/second</span>
<span class="token attr-name">app.datasource.second.username</span><span class="token punctuation">=</span><span class="token attr-value">dbuser</span>
<span class="token attr-name">app.datasource.second.password</span><span class="token punctuation">=</span><span class="token attr-value">dbpass</span>
<span class="token attr-name">app.datasource.second.max-total</span><span class="token punctuation">=</span><span class="token attr-value">30</span>
</code></pre></div><p>您也可以将相同的概念应用于辅助数据源，如下面的示例所示:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@Primary</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span><span class="token string">&quot;app.datasource.first&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">DataSourceProperties</span> <span class="token function">firstDataSourceProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DataSourceProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@Primary</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span><span class="token string">&quot;app.datasource.first.configuration&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">HikariDataSource</span> <span class="token function">firstDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">firstDataSourceProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">initializeDataSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token class-name">HikariDataSource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span><span class="token string">&quot;app.datasource.second&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">DataSourceProperties</span> <span class="token function">secondDataSourceProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DataSourceProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span><span class="token string">&quot;app.datasource.second.configuration&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">BasicDataSource</span> <span class="token function">secondDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">secondDataSourceProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">initializeDataSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token class-name">BasicDataSource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>前面的示例在自定义名称空间上配置两个数据源，使用与Spring Boot在自动配置中使用的逻辑相同的逻辑。注意，每个配置子名称空间都提供基于所选实现的高级设置。</p> <h3 id="_84-3使用spring-data-repositories"><a href="#_84-3使用spring-data-repositories" aria-hidden="true" class="header-anchor">#</a> 84.3使用Spring Data Repositories</h3> <p>Spring Data可以创建各种风格的@Repository接口的实现。 Spring Boot会为您处理所有这些，只要这些@Repositories包含在@EnableAutoConfiguration类的同一个包（或子包）中。</p> <p>对于许多应用程序，您只需要在类路径上放置正确的Spring Data依赖项（对于JPA有一个spring-boot-starter-data-jpa，对于Mongodb有一个spring-boot-starter-data-mongodb）并创建一些存储库接口来处理您的@Entity对象。例子在JPA样本和Mongodb样本中。</p> <p>Spring Boot会根据找到的@EnableAutoConfiguration尝试猜测@Repository定义的位置。要获得更多控制，请使用@EnableJpaRepositories注释（来自Spring Data JPA）。</p> <p>有关Spring Data的更多信息，请参阅Spring Data项目页面。</p> <h3 id="_84-4从spring配置中分离-entity定义"><a href="#_84-4从spring配置中分离-entity定义" aria-hidden="true" class="header-anchor">#</a> 84.4从Spring配置中分离@Entity定义</h3> <p>Spring Boot会根据找到的@EnableAutoConfiguration尝试猜测@Entity定义的位置。要获得更多控制，可以使用@EntityScan批注，如以下示例所示：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableAutoConfiguration</span>
<span class="token annotation punctuation">@EntityScan</span><span class="token punctuation">(</span>basePackageClasses<span class="token operator">=</span><span class="token class-name">City</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>

	<span class="token comment">//...</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="_84-5配置jpa属性"><a href="#_84-5配置jpa属性" aria-hidden="true" class="header-anchor">#</a> 84.5配置JPA属性</h3> <p>Spring Data JPA已经提供了一些独立于供应商的配置选项（例如用于SQL日志记录的选项），Spring Boot公开了这些选项以及一些Hibernate作为外部配置属性的选项。 根据上下文自动检测其中一些，因此您不必设置它们。</p> <p>spring.jpa.hibernate.ddl-auto是一种特殊情况，因为根据运行时条件，它具有不同的默认值。 如果使用嵌入式数据库且没有架构管理器（例如Liquibase或Flyway）正在处理DataSource，则默认为create-drop。 在所有其他情况下，默认为none。</p> <p>还可以根据当前的DataSource自动检测要使用的方言，但是如果要显式并且在启动时绕过该检查，则可以自己设置spring.jpa.database。</p> <p>指定数据库会导致配置明确定义的Hibernate方言。 有几个数据库有多个Dialect，这可能不适合您的需求。 在这种情况下，您可以将spring.jpa.database设置为default，让Hibernate通过设置spring.jpa.database-platform属性来解决问题。</p> <p>最常见的设置选项如下例所示:</p> <div class="language- extra-class"><pre class="language-text"><code>spring.jpa.hibernate.naming.physical-strategy=com.example.MyPhysicalNamingStrategy
spring.jpa.show-sql=true
</code></pre></div><p>此外，当创建本地EntityManagerFactory时，spring.jpa.properties。*中的所有属性都作为普通的JPA属性（带有前缀剥离）传递。</p> <blockquote><p>如果需要对Hibernate属性应用高级自定义，请考虑注册将在创建EntityManagerFactory之前调用的HibernatePropertiesCustomizer bean。 这优先于自动配置应用的任何内容。</p></blockquote> <h3 id="_84-6配置hibernate命名策略"><a href="#_84-6配置hibernate命名策略" aria-hidden="true" class="header-anchor">#</a> 84.6配置Hibernate命名策略</h3> <p>Hibernate使用两种不同的命名策略将名称从对象模型映射到相应的数据库名称。可以通过分别设置spring.jpa.hibernate.naming.physical-strategy和spring.jpa.hibernate.naming.implicit-strategy属性来配置物理策略实现和隐式策略实现的完全限定类名。或者，如果应用程序上下文中有ImplicitNamingStrategy或PhysicalNamingStrategy bean，Hibernate将自动配置为使用它们。</p> <p>默认情况下，Spring Boot使用SpringPhysicalNamingStrategy配置物理命名策略。这个实现提供了与Hibernate 4相同的表结构：所有点都被下划线替换，而驼峰外壳也被下划线替换。默认情况下，所有表名都以小写形式生成，但如果您的架构需要，则可以覆盖该标志。</p> <p>例如，TelephoneNumber实体被映射到telephone_number表。</p> <p>如果您更喜欢使用Hibernate 5的默认设置，请设置以下属性：</p> <div class="language- extra-class"><pre class="language-text"><code>spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
</code></pre></div><p>或者，您可以配置以下bean:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">PhysicalNamingStrategy</span> <span class="token function">physicalNamingStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PhysicalNamingStrategyStandardImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>有关详细信息，请参见HibernateJpaAutoConfiguration和JpaBaseConfiguration。</p> <h3 id="_84-7配置hibernate二级缓存"><a href="#_84-7配置hibernate二级缓存" aria-hidden="true" class="header-anchor">#</a> 84.7配置Hibernate二级缓存</h3> <p>可以为一系列缓存提供程序配置Hibernate二级缓存。 不是将Hibernate配置为再次查找缓存提供程序，最好尽可能提供上下文中可用的那个。</p> <p>如果你正在使用JCache，这很容易。 首先，确保org.hibernate：hibernate-jcache在类路径上可用。 然后，添加一个HibernatePropertiesCustomizer bean，如以下示例所示：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HibernateSecondLevelCacheExample</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Bean</span>
	<span class="token keyword">public</span> <span class="token class-name">HibernatePropertiesCustomizer</span> <span class="token function">hibernateSecondLevelCacheCustomizer</span><span class="token punctuation">(</span>
			<span class="token class-name">JCacheCacheManager</span> cacheManager<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span>properties<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConfigSettings</span><span class="token punctuation">.</span>CACHE_MANAGER<span class="token punctuation">,</span>
				cacheManager<span class="token punctuation">.</span><span class="token function">getCacheManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>此自定义程序将配置Hibernate以使用与应用程序使用的CacheManager相同的CacheManager。也可以使用单独的CacheManager实例。有关详细信息，请参阅Hibernate用户指南。</p> <h3 id="_84-8在hibernate组件中使用依赖注入"><a href="#_84-8在hibernate组件中使用依赖注入" aria-hidden="true" class="header-anchor">#</a> 84.8在Hibernate组件中使用依赖注入</h3> <p>默认情况下，Spring Boot注册使用BeanFactory的BeanContainer实现，以便转换器和实体侦听器可以使用常规依赖注入。</p> <p>您可以通过注册删除或更改hibernate.resource.beans.container属性的HibernatePropertiesCustomizer来禁用或调整此行为。</p> <h3 id="_84-9使用自定义entitymanagerfactory"><a href="#_84-9使用自定义entitymanagerfactory" aria-hidden="true" class="header-anchor">#</a> 84.9使用自定义EntityManagerFactory</h3> <p>要完全控制EntityManagerFactory的配置，需要添加名为“entityManagerFactory”的@Bean。 Spring Boot自动配置在存在该类型的bean时关闭其实体管理器。</p> <h3 id="_84-10使用两个entitymanagers"><a href="#_84-10使用两个entitymanagers" aria-hidden="true" class="header-anchor">#</a> 84.10使用两个EntityManagers</h3> <p>即使默认的EntityManagerFactory工作正常，您也需要定义一个新的。否则，该类型的第二个bean的存在将关闭默认值。为了方便起见，您可以使用Spring Boot提供的方便的EntityManagerBuilder。或者，您可以直接从Spring ORM中获取LocalContainerEntityManagerFactoryBean，如以下示例所示：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// add two data sources configured as above</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">LocalContainerEntityManagerFactoryBean</span> <span class="token function">customerEntityManagerFactory</span><span class="token punctuation">(</span>
		<span class="token class-name">EntityManagerFactoryBuilder</span> builder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> builder
			<span class="token punctuation">.</span><span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token function">customerDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">packages</span><span class="token punctuation">(</span><span class="token class-name">Customer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">persistenceUnit</span><span class="token punctuation">(</span><span class="token string">&quot;customers&quot;</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">LocalContainerEntityManagerFactoryBean</span> <span class="token function">orderEntityManagerFactory</span><span class="token punctuation">(</span>
		<span class="token class-name">EntityManagerFactoryBuilder</span> builder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> builder
			<span class="token punctuation">.</span><span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token function">orderDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">packages</span><span class="token punctuation">(</span><span class="token class-name">Order</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">persistenceUnit</span><span class="token punctuation">(</span><span class="token string">&quot;orders&quot;</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面的配置几乎可以单独使用。 要完成图片，您还需要为两个EntityManagers配置TransactionManagers。 如果你将其中一个标记为@Primary，它可以被Spring Boot中的默认JpaTransactionManager选中。 另一个必须明确地注入新实例。 或者，您可以使用跨越两者的JTA事务管理器。</p> <p>如果使用Spring Data，则需要相应地配置@EnableJpaRepositories，如以下示例所示：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableJpaRepositories</span><span class="token punctuation">(</span>basePackageClasses <span class="token operator">=</span> <span class="token class-name">Customer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
		entityManagerFactoryRef <span class="token operator">=</span> <span class="token string">&quot;customerEntityManagerFactory&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomerConfiguration</span> <span class="token punctuation">{</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableJpaRepositories</span><span class="token punctuation">(</span>basePackageClasses <span class="token operator">=</span> <span class="token class-name">Order</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
		entityManagerFactoryRef <span class="token operator">=</span> <span class="token string">&quot;orderEntityManagerFactory&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderConfiguration</span> <span class="token punctuation">{</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_84-11使用传统的persistence-xml文件"><a href="#_84-11使用传统的persistence-xml文件" aria-hidden="true" class="header-anchor">#</a> 84.11使用传统的persistence.xml文件</h3> <p>默认情况下，Spring Boot不会搜索或使用META-INF / persistence.xml。如果您更喜欢使用传统的persistence.xml，则需要定义自己的类型为LocalEntityManagerFactoryBean的@Bean（ID为'entityManagerFactory'）并在其中设置持久性单元名称。</p> <p>有关默认设置，请参阅JpaBaseConfiguration。</p> <h3 id="_84-12使用spring-data-jpa和mongo存储库"><a href="#_84-12使用spring-data-jpa和mongo存储库" aria-hidden="true" class="header-anchor">#</a> 84.12使用Spring Data JPA和Mongo存储库</h3> <p>Spring Data JPA和Spring Data Mongo都可以自动为您创建Repository实现。如果它们都存在于类路径中，则可能需要执行一些额外的配置来告诉Spring Boot要创建哪些存储库。最明确的方法是使用标准的Spring Data @EnableJpaRepositories和@EnableMongoRepositories注释，并提供Repository接口的位置。</p> <p>还有标志（spring.data。<em>。repositories.enabled和spring.data。</em>。repositories.type），您可以使用这些标志在外部配置中打开和关闭自动配置的存储库。这样做很有用，例如，如果您想关闭Mongo存储库并仍然使用自动配置的MongoTemplate。</p> <p>其他自动配置的Spring Data存储库类型（Elasticsearch，Solr等）也存在相同的障碍和相同的功能。要使用它们，请相应地更改注释和标志的名称。</p> <h3 id="_84-13自定义spring-data的web支持"><a href="#_84-13自定义spring-data的web支持" aria-hidden="true" class="header-anchor">#</a> 84.13自定义Spring Data的Web支持</h3> <p>Spring Data提供Web支持，简化了Web应用程序中Spring Data存储库的使用。 Spring Boot在spring.data.web命名空间中提供属性以自定义其配置。请注意，如果您使用的是Spring Data REST，则必须使用spring.data.rest命名空间中的属性。</p> <h3 id="_84-14将spring数据存储库公开为rest端点"><a href="#_84-14将spring数据存储库公开为rest端点" aria-hidden="true" class="header-anchor">#</a> 84.14将Spring数据存储库公开为REST端点</h3> <p>如果为应用程序启用了Spring MVC，Spring Data REST可以为您公开Repository实现作为REST端点。</p> <p>Spring Boot公开了一组自定义RepositoryRestConfiguration的有用属性（来自spring.data.rest命名空间）。如果需要提供其他自定义，则应使用RepositoryRestConfigurer bean。</p> <blockquote><p>如果未在自定义RepositoryRestConfigurer上指定任何顺序，则它将在内部使用一个Spring Boot之后运行。 如果需要指定订单，请确保订单高于0。</p></blockquote> <h3 id="_84-15配置jpa使用的组件"><a href="#_84-15配置jpa使用的组件" aria-hidden="true" class="header-anchor">#</a> 84.15配置JPA使用的组件</h3> <p>如果要配置JPA使用的组件，则需要确保在JPA之前初始化组件。 组件自动配置后，Spring Boot会为您完成此操作。 例如，当自动配置Flyway时，Hibernate配置为依赖于Flyway，以便在Hibernate尝试使用它之前，Flyway有机会初始化数据库。</p> <p>如果您自己配置组件，则可以使用EntityManagerFactoryDependsOnPostProcessor子类作为设置必要依赖项的便捷方法。 例如，如果将Hibernate Search与Elasticsearch一起用作其索引管理器，则必须将任何EntityManagerFactory bean配置为依赖elasticsearchClient bean，如以下示例所示：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * {@link EntityManagerFactoryDependsOnPostProcessor} that ensures that
 * {@link EntityManagerFactory} beans depend on the {@code elasticsearchClient} bean.
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">ElasticsearchJpaDependencyConfiguration</span>
		<span class="token keyword">extends</span> <span class="token class-name">EntityManagerFactoryDependsOnPostProcessor</span> <span class="token punctuation">{</span>

	<span class="token class-name">ElasticsearchJpaDependencyConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span><span class="token string">&quot;elasticsearchClient&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="_84-16使用两个datasource配置jooq"><a href="#_84-16使用两个datasource配置jooq" aria-hidden="true" class="header-anchor">#</a> 84.16使用两个DataSource配置jOOQ</h3> <p>如果您需要将jOOQ用于多个数据源，则应为每个数据源创建自己的DSLContext。 有关更多详细信息，请参阅JooqAutoConfiguration。</p> <blockquote><p>特别是，可以重用JooqExceptionTranslator和SpringTransactionProvider来提供与单个DataSource的自动配置相似的功能。</p></blockquote> <h2 id="_85-数据库初始化"><a href="#_85-数据库初始化" aria-hidden="true" class="header-anchor">#</a> 85.数据库初始化</h2> <p>可以使用不同的方式初始化SQL数据库，具体取决于堆栈的内容。 当然，如果数据库是一个单独的过程，您也可以手动完成。 建议使用单一机制生成模式。</p> <h3 id="_85-1使用jpa初始化数据库"><a href="#_85-1使用jpa初始化数据库" aria-hidden="true" class="header-anchor">#</a> 85.1使用JPA初始化数据库</h3> <p>JPA具有DDL生成功能，可以将这些功能设置为在数据库启动时运行。这是通过两个外部属性控制的：</p> <ul><li>spring.jpa.generate-ddl（boolean）打开和关闭该功能，与供应商无关。</li> <li>spring.jpa.hibernate.ddl-auto（enum）是一个Hibernate功能，它以更细粒度的方式控制行为。本指南后面将详细介绍此功能。</li></ul> <h3 id="_85-2使用hibernate初始化数据库"><a href="#_85-2使用hibernate初始化数据库" aria-hidden="true" class="header-anchor">#</a> 85.2使用Hibernate初始化数据库</h3> <p>您可以显式设置spring.jpa.hibernate.ddl-auto，标准Hibernate属性值为none，validate，update，create和create-drop。 Spring Boot会根据是否认为您的数据库是嵌入式的，为您选择一个默认值。如果未检测到架构管理器，则默认为create-drop，在所有其他情况下，默认为none。通过查看连接类型来检测嵌入式数据库。 hsqldb，h2和derby是嵌入的，而其他则不是。从内存切换到“真实”数据库时要小心，不要假设新平台中存在表和数据。您必须显式设置ddl-auto或使用其他机制之一来初始化数据库。</p> <blockquote><p>[注意]
您可以通过启用org.hibernate.SQL记录器来输出架构创建。如果启用调试模式，则会自动完成此操作。</p></blockquote> <p>此外，如果Hibernate从头开始创建架构（即，如果ddl-auto属性设置为create或create-drop），则在启动时会在启动时执行类路径根目录中名为import.sql的文件。这对于演示和测试很有用，如果你小心，但可能不是你想要在生产中的类路径上。它是一个Hibernate功能（与Spring无关）。</p> <h3 id="_85-3初始化数据库"><a href="#_85-3初始化数据库" aria-hidden="true" class="header-anchor">#</a> 85.3初始化数据库</h3> <p>Spring Boot可以自动创建DataSource的模式（DDL脚本）并对其进行初始化（DML脚本）。它从标准的根类路径位置加载SQL：schema.sql和data.sql。此外，Spring Boot处理模式 -  $ {platform} .sql和data  -  $ {platform} .sql文件（如果存在），其中platform是spring.datasource.platform的值。这允许您在必要时切换到特定于数据库的脚本。例如，您可以选择将其设置为数据库的供应商名称（hsqldb，h2，oracle，mysql，postgresql等）。</p> <blockquote><p>[注意]
Spring Boot自动创建嵌入式DataSource的模式。可以使用spring.datasource.initialization-mode属性自定义此行为。例如，如果要始终初始化DataSource，而不管其类型如何：spring.datasource.initializationmode=always</p></blockquote> <p>默认情况下，Spring Boot启用Spring JDBC初始化程序的快速故障功能。这意味着，如果脚本导致异常，则应用程序无法启动。您可以通过设置spring.datasource.continue-on-error来调整该行为。</p> <blockquote><p>[注意]
在基于JPA的应用程序中，您可以选择让Hibernate创建模式或使用schema.sql，但您不能同时执行这两个操作。如果使用schema.sql，请确保禁用spring.jpa.hibernate.ddl-auto。</p></blockquote> <h3 id="_85-4初始化spring-batch数据库"><a href="#_85-4初始化spring-batch数据库" aria-hidden="true" class="header-anchor">#</a> 85.4初始化Spring Batch数据库</h3> <p>如果您使用Spring Batch，它会预先打包用于大多数流行数据库平台的SQL初始化脚本。 Spring Boot可以检测您的数据库类型并在启动时执行这些脚本。 如果使用嵌入式数据库，默认情况下会发生这种情况。 您还可以为任何数据库类型启用它，如以下示例所示：</p> <div class="language- extra-class"><pre class="language-text"><code>spring.batch.initialize-schema=always
</code></pre></div><p>您还可以通过设置spring.batch.initialize-schema = never来显式关闭初始化。</p> <h3 id="_85-5使用更高级别的数据库迁移工具"><a href="#_85-5使用更高级别的数据库迁移工具" aria-hidden="true" class="header-anchor">#</a> 85.5使用更高级别的数据库迁移工具</h3> <p>Spring Boot支持两种更高级别的迁移工具：Flyway和Liquibase。</p> <h4 id="_85-5-1在启动时执行flyway数据库迁移"><a href="#_85-5-1在启动时执行flyway数据库迁移" aria-hidden="true" class="header-anchor">#</a> 85.5.1在启动时执行Flyway数据库迁移</h4> <p>要在启动时自动运行Flyway数据库迁移，请将org.flywaydb：flyway-core添加到类路径中。</p> <p>迁移是V <code>&lt;VERSION&gt; __ &lt;NAME&gt;</code> .sql形式的脚本（<code>&lt;VERSION&gt;</code>下划线分隔版本，例如'1'或'2_1'）。 默认情况下，它们位于名为classpath：db / migration的文件夹中，但您可以通过设置spring.flyway.locations来修改该位置。 这是一个以逗号分隔的列表，其中包含一个或多个classpath：或filesystem：locations。 例如，以下配置将在默认类路径位置和/ opt / migration目录中搜索脚本：</p> <div class="language- extra-class"><pre class="language-text"><code>spring.flyway.locations=classpath:db/migration,filesystem:/opt/migration
</code></pre></div><p>您还可以添加特殊的{vendor}占位符以使用特定于供应商的脚本。 假设如下：</p> <div class="language- extra-class"><pre class="language-text"><code>spring.flyway.locations=classpath:db/migration/{vendor}
</code></pre></div><p>前面的配置不是使用db / migration，而是根据数据库的类型设置要使用的文件夹（例如MySQL的db / migration / mysql）。 DatabaseDriver中提供了受支持的数据库列表。</p> <p>FlywayProperties提供了大部分Flyway的设置和一小组附加属性，可用于禁用迁移或关闭位置检查。如果需要更多控制配置，请考虑注册FlywayConfigurationCustomizer bean。</p> <p>Spring Boot调用Flyway.migrate（）来执行数据库迁移。如果您想要更多控制，请提供实现FlywayMigrationStrategy的@Bean。</p> <p>Flyway支持SQL和Java回调。要使用基于SQL的回调，请将回调脚本放在classpath：db / migration文件夹中。要使用基于Java的回调，请创建一个或多个实现Callback的bean。任何此类bean都会自动在Flyway注册。可以使用@Order或通过实现Ordered来订购它们。也可以检测实现已弃用的FlywayCallback接口的Bean，但它们不能与Callback bean一起使用。</p> <p>默认情况下，Flyway会在您的上下文中自动装配（@Primary）DataSource并将其用于迁移。如果您想使用其他DataSource，可以创建一个并将其@Bean标记为@FlywayDataSource。如果您这样做并想要两个数据源，请记住创建另一个数据源并将其标记为@Primary。或者，您可以通过在外部属性中设置spring.flyway。[url，user，password]来使用Flyway的本机DataSource。设置spring.flyway.url或spring.flyway.user足以使Flyway使用自己的DataSource。如果尚未设置三个属性中的任何一个，则将使用其等效的spring.datasource属性的值。</p> <p>有一个Flyway示例，您可以看到如何设置。</p> <p>您还可以使用Flyway为特定方案提供数据。例如，您可以在src / test / resources中放置特定于测试的迁移，并且只有在应用程序启动进行测试时才会运行它们。此外，您可以使用特定于配置文件的配置来自定义spring.flyway.locations，以便某些迁移仅在特定配置文件处于活动状态时运行。例如，在application-dev.properties中，您可以指定以下设置：</p> <div class="language- extra-class"><pre class="language-text"><code>spring.flyway.locations=classpath:/db/migration,classpath:/dev/db/migration
</code></pre></div><p>使用该设置，dev/db/migration中的迁移只在dev概要文件处于活动状态时运行。</p> <h4 id="_85-5-2在启动时执行liquibase数据库迁移"><a href="#_85-5-2在启动时执行liquibase数据库迁移" aria-hidden="true" class="header-anchor">#</a> 85.5.2在启动时执行Liquibase数据库迁移</h4> <p>要在启动时自动运行Liquibase数据库迁移，请将org.liquibase：liquibase-core添加到类路径中。</p> <p>默认情况下，从db / changelog / db.changelog-master.yaml读取主更改日志，但您可以通过设置spring.liquibase.change-log来更改位置。除了YAML，Liquibase还支持JSON，XML和SQL更改日志格式。</p> <p>默认情况下，Liquibase会在您的上下文中自动装配（@Primary）DataSource并将其用于迁移。如果需要使用其他DataSource，可以创建一个并将其@Bean标记为@LiquibaseDataSource。如果您这样做并且想要两个数据源，请记住创建另一个数据源并将其标记为@Primary。或者，您可以通过在外部属性中设置spring.liquibase。[url，user，password]来使用Liquibase的本机DataSource。设置spring.liquibase.url或spring.liquibase.user足以使Liquibase使用自己的DataSource。如果尚未设置三个属性中的任何一个，则将使用其等效的spring.datasource属性的值。</p> <p>有关可用设置（如上下文，默认架构等）的详细信息，请参阅LiquibaseProperties。</p> <p>有一个Liquibase样本，以便您可以看到如何设置。</p> <h2 id="_86-messaging"><a href="#_86-messaging" aria-hidden="true" class="header-anchor">#</a> 86. Messaging</h2> <p>Spring Boot提供了许多启动程序，其中包括消息传递。本节回答在Spring Boot中使用消息传递时产生的问题。</p> <h3 id="_86-1禁用已事务处理的jms会话"><a href="#_86-1禁用已事务处理的jms会话" aria-hidden="true" class="header-anchor">#</a> 86.1禁用已事务处理的JMS会话</h3> <p>如果您的JMS代理不支持事务会话，则必须完全禁用事务支持。 如果您创建自己的JmsListenerContainerFactory，则无需执行任何操作，因为默认情况下无法进行事务处理。 如果要使用DefaultJmsListenerContainerFactoryConfigurer重用Spring Boot的默认值，可以禁用事务处理会话，如下所示：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">DefaultJmsListenerContainerFactory</span> <span class="token function">jmsListenerContainerFactory</span><span class="token punctuation">(</span>
		<span class="token class-name">ConnectionFactory</span> connectionFactory<span class="token punctuation">,</span>
		<span class="token class-name">DefaultJmsListenerContainerFactoryConfigurer</span> configurer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">DefaultJmsListenerContainerFactory</span> listenerFactory <span class="token operator">=</span>
			<span class="token keyword">new</span> <span class="token class-name">DefaultJmsListenerContainerFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	configurer<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span>listenerFactory<span class="token punctuation">,</span> connectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
	listenerFactory<span class="token punctuation">.</span><span class="token function">setTransactionManager</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	listenerFactory<span class="token punctuation">.</span><span class="token function">setSessionTransacted</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> listenerFactory<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面的示例将覆盖默认工厂，并且应该应用于应用程序定义的任何其他工厂（如果有）。</p> <h2 id="_87-批量申请"><a href="#_87-批量申请" aria-hidden="true" class="header-anchor">#</a> 87.批量申请</h2> <p>本节回答使用Spring Batch with Spring Boot产生的问题。</p> <blockquote><p>默认情况下，批处理应用程序需要DataSource来存储作业详细信息。 如果要偏离它，则需要实现BatchConfigurer。 有关更多详细信息，请参阅@EnableBatchProcessing的Javadoc。</p></blockquote> <p>有关Spring Batch的更多信息，请参见Spring Batch项目页面。</p> <h3 id="_87-1在启动时执行spring批处理作业"><a href="#_87-1在启动时执行spring批处理作业" aria-hidden="true" class="header-anchor">#</a> 87.1在启动时执行Spring批处理作业</h3> <p>通过在上下文中的某处添加@EnableBatchProcessing（来自Spring Batch）来启用Spring Batch自动配置。</p> <p>默认情况下，它在启动时在应用程序上下文中执行所有作业（有关详细信息，请参阅JobLauncherCommandLineRunner）。 您可以通过指定spring.batch.job.names（以逗号分隔的作业名称模式列表）缩小到特定的作业或作业。</p> <blockquote><p>与在环境中设置属性的命令行选项参数（即以 - 开头，例如--my-property = value）不同，必须在命令行上指定作业参数而不使用破折号（例如jobParam = value）。</p></blockquote> <p>如果应用程序上下文包含JobRegistry，则spring.batch.job.names中的作业将在注册表中查找，而不是从上下文中自动装配。 这是一个具有更复杂系统的常见模式，其中多个作业在子上下文中定义并集中注册。</p> <p>有关更多详细信息，请参阅BatchAutoConfiguration和@EnableBatchProcessing。</p> <h2 id="_88-执行器"><a href="#_88-执行器" aria-hidden="true" class="header-anchor">#</a> 88.执行器</h2> <p>Spring Boot包括Spring Boot Actuator。本节回答了其使用中经常出现的问题。</p> <h3 id="_88-1更改执行器端点的http端口或地址"><a href="#_88-1更改执行器端点的http端口或地址" aria-hidden="true" class="header-anchor">#</a> 88.1更改执行器端点的HTTP端口或地址</h3> <p>在独立应用程序中，Actuator HTTP端口默认与主HTTP端口相同。要使应用程序侦听其他端口，请设置外部属性：management.server.port。要侦听完全不同的网络地址（例如，当您有用于管理的内部网络和用于用户应用程序的外部网络时），您还可以将management.server.address设置为服务器能够绑定到的有效IP地址。</p> <p>有关更多详细信息，请参阅“生产就绪功能”部分中的ManagementServerProperties源代码和“部分54.2，”自定义管理服务器端口“”。</p> <h3 id="_88-2自定义-whitelabel-错误页面"><a href="#_88-2自定义-whitelabel-错误页面" aria-hidden="true" class="header-anchor">#</a> 88.2自定义'whitelabel'错误页面</h3> <p>如果您遇到服务器错误，Spring Boot将安装您在浏览器客户端中看到的“whitelabel”错误页面（使用JSON和其他媒体类型的计算机客户端应该看到具有正确错误代码的合理响应）。</p> <blockquote><p>设置server.error.whitelabel.enabled = false以关闭默认错误页面。 这样做会恢复您正在使用的servlet容器的默认值。 请注意，Spring Boot仍会尝试解析错误视图，因此您应该添加自己的错误页面，而不是完全禁用它。</p></blockquote> <p>使用您自己的错误页面覆盖错误页面取决于您使用的模板技术。例如，如果您使用Thymeleaf，则可以添加error.html模板。如果您使用FreeMarker，则可以添加error.ftl模板。通常，您需要一个以错误名称解析的View或一个处理/错误路径的@Controller。除非您替换了一些默认配置，否则您应该在ApplicationContext中找到BeanNameViewResolver，因此@Bean命名错误将是一种简单的方法。有关更多选项，请参见ErrorMvcAutoConfiguration。</p> <p>有关如何在servlet容器中注册处理程序的详细信息，另请参阅“错误处理”一节。</p> <h3 id="_88-3消除敏感价值"><a href="#_88-3消除敏感价值" aria-hidden="true" class="header-anchor">#</a> 88.3消除敏感价值</h3> <p>env和configprops端点返回的信息可能有些敏感，因此默认情况下将匹配某个模式的密钥进行清理（即它们的值由******替换）。</p> <p>Spring Boot对这些密钥使用合理的默认值：例如，任何以“password”，“secret”，“key”或“token”结尾的密钥都将被清理。也可以使用正则表达式，例如* credentials。*来清理任何将单词凭证作为密钥的一部分的密钥。</p> <p>可以使用management.endpoint.env.keys-to-sanitize和management.endpoint.configprops.keys-to-sanitize分别自定义要使用的模式。</p> <h2 id="_89-安全"><a href="#_89-安全" aria-hidden="true" class="header-anchor">#</a> 89.安全</h2> <p>本节介绍使用Spring Boot时的安全性问题，包括使用Spring Boot with Spring Boot时出现的问题。</p> <p>有关Spring Security的更多信息，请参阅Spring Security项目页面。</p> <h3 id="_89-1关闭spring-boot安全配置"><a href="#_89-1关闭spring-boot安全配置" aria-hidden="true" class="header-anchor">#</a> 89.1关闭Spring Boot安全配置</h3> <p>如果在应用程序中使用WebSecurityConfigurerAdapter定义@Configuration，则会关闭Spring Boot中的默认Webapp安全设置。</p> <h3 id="_89-2更改userdetailsservice和添加用户帐户"><a href="#_89-2更改userdetailsservice和添加用户帐户" aria-hidden="true" class="header-anchor">#</a> 89.2更改UserDetailsService和添加用户帐户</h3> <p>如果您提供类型为AuthenticationManager，AuthenticationProvider或UserDetailsService的@Bean，则不会创建InMemoryUserDetailsManager的默认@Bean，因此您可以使用Spring Security的完整功能集（例如各种身份验证选项）。</p> <p>添加用户帐户的最简单方法是提供自己的UserDetailsService bean。</p> <h3 id="_89-3在代理服务器后面运行时启用https"><a href="#_89-3在代理服务器后面运行时启用https" aria-hidden="true" class="header-anchor">#</a> 89.3在代理服务器后面运行时启用HTTPS</h3> <p>确保所有主要端点仅通过HTTPS可用是任何应用程序的重要工作。 如果您使用Tomcat作为servlet容器，那么Spring Boot会在检测到某些环境设置时自动添加Tomcat自己的RemoteIpValve，并且您应该能够依赖HttpServletRequest来报告它是否安全（甚至是代理服务器的下游） 处理真正的SSL终止）。 标准行为取决于某些请求标头（x-forwarded-for和x-forwarded-proto）的存在与否，其名称是常规的，因此它应该适用于大多数前端代理。 您可以通过向application.properties添加一些条目来打开阀门，如以下示例所示：</p> <div class="language- extra-class"><pre class="language-text"><code>server.tomcat.remote-ip-header=x-forwarded-for
server.tomcat.protocol-header=x-forwarded-proto
</code></pre></div><p>（其中任何一个属性的存在都会打开阀门。或者，您可以通过添加TomcatServletWebServerFactory bean来添加RemoteIpValve。）</p> <p>要将Spring Security配置为要求所有（或某些）请求的安全通道，请考虑添加自己的WebSecurityConfigurerAdapter，以添加以下HttpSecurity配置：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SslWebSecurityConfigurerAdapter</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
		<span class="token comment">// Customize the application security</span>
		http<span class="token punctuation">.</span><span class="token function">requiresChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">requiresSecure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h2 id="_90-热插拔"><a href="#_90-热插拔" aria-hidden="true" class="header-anchor">#</a> 90.热插拔</h2> <p>Spring Boot支持热交换。本节回答有关其工作原理的问题。</p> <h3 id="_90-1重新加载静态内容"><a href="#_90-1重新加载静态内容" aria-hidden="true" class="header-anchor">#</a> 90.1重新加载静态内容</h3> <p>热重装有几种选择。推荐的方法是使用spring-boot-devtools，因为它提供了额外的开发时间功能，例如支持快速应用程序重启和LiveReload以及合理的开发时配置（例如模板缓存）。 Devtools通过监视类路径进行更改来工作。这意味着必须“构建”静态资源更改才能使更改生效。默认情况下，当您保存更改时，这会自动发生在Eclipse中。在IntelliJ IDEA中，Make Project命令会触发必要的构建。由于默认的重新启动排除，对静态资源的更改不会触发应用程序的重新启动。但是，它们会触发实时重新加载。</p> <p>或者，在IDE中运行（尤其是在调试时）是一种很好的开发方式（所有现代IDE都允许重新加载静态资源，并且通常还允许热插拔Java类更改）。</p> <p>最后，可以配置Maven和Gradle插件（请参阅addResources属性）以支持从命令行运行，并直接从源重新加载静态文件。如果您使用更高级别的工具编写该代码，则可以将其与外部css / js编译器进程一起使用。</p> <h3 id="_90-2重新加载模板而不重新启动容器"><a href="#_90-2重新加载模板而不重新启动容器" aria-hidden="true" class="header-anchor">#</a> 90.2重新加载模板而不重新启动容器</h3> <p>Spring Boot支持的大多数模板技术都包含一个禁用缓存的配置选项（本文档后面会介绍）。如果使用spring-boot-devtools模块，则会在开发时自动为您配置这些属性。</p> <h4 id="_90-2-1-thymeleaf模板"><a href="#_90-2-1-thymeleaf模板" aria-hidden="true" class="header-anchor">#</a> 90.2.1 Thymeleaf模板</h4> <p>如果您使用Thymeleaf，请将spring.thymeleaf.cache设置为false。有关其他Thymeleaf自定义选项，请参阅ThymeleafAutoConfiguration。</p> <h4 id="_90-2-2-freemarker模板"><a href="#_90-2-2-freemarker模板" aria-hidden="true" class="header-anchor">#</a> 90.2.2 FreeMarker模板</h4> <p>如果您使用FreeMarker，请将spring.freemarker.cache设置为false。有关其他FreeMarker自定义选项，请参阅FreeMarkerAutoConfiguration。</p> <h4 id="_90-2-3-groovy模板"><a href="#_90-2-3-groovy模板" aria-hidden="true" class="header-anchor">#</a> 90.2.3 Groovy模板</h4> <p>如果使用Groovy模板，请将spring.groovy.template.cache设置为false。有关其他Groovy自定义选项，请参阅GroovyTemplateAutoConfiguration。</p> <h3 id="_90-3快速应用程序重新启动"><a href="#_90-3快速应用程序重新启动" aria-hidden="true" class="header-anchor">#</a> 90.3快速应用程序重新启动</h3> <p>spring-boot-devtools模块支持自动应用程序重启。虽然没有像JRebel这样的技术那么快，但它通常比“冷启动”快得多。在调查本文档后面讨论的一些更复杂的重载选项之前，您应该尝试一下。</p> <p>有关更多详细信息，请参见第20章“开发人员工具”部分。</p> <h3 id="_90-4重新加载java类而不重新启动容器"><a href="#_90-4重新加载java类而不重新启动容器" aria-hidden="true" class="header-anchor">#</a> 90.4重新加载Java类而不重新启动容器</h3> <p>许多现代IDE（Eclipse，IDEA和其他）支持字节码的热交换。 因此，如果您进行的更改不会影响类或方法签名，则应该干净地重新加载，不会产生任何副作用。</p> <h2 id="_91-建立"><a href="#_91-建立" aria-hidden="true" class="header-anchor">#</a> 91.建立</h2> <p>Spring Boot包含Maven和Gradle的构建插件。 本节回答有关这些插件的常见问题。</p> <h3 id="_91-1生成构建信息"><a href="#_91-1生成构建信息" aria-hidden="true" class="header-anchor">#</a> 91.1生成构建信息</h3> <p>Maven插件和Gradle插件都允许生成包含项目坐标，名称和版本的构建信息。 插件还可以配置为通过配置添加其他属性。 当存在这样的文件时，Spring Boot会自动配置BuildProperties bean。</p> <p>要使用Maven生成构建信息，请为build-info目标添加执行，如以下示例所示：</p> <div class="language-xml extra-class"><pre class="language-xml"><code>	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.1.3.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executions</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>execution</span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goals</span><span class="token punctuation">&gt;</span></span>
						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goal</span><span class="token punctuation">&gt;</span></span>build-info<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goal</span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goals</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>execution</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executions</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><blockquote><p>有关详细信息，请参阅Spring Boot Maven插件文档。<code>&lt;build&gt;</code></p></blockquote> <p>下面的例子也适用于Gradle:</p> <div class="language- extra-class"><pre class="language-text"><code>springBoot {
	buildInfo()
}
</code></pre></div><p>有关详细信息，请参阅Spring Boot Gradle插件文档。</p> <h3 id="_91-2生成git信息"><a href="#_91-2生成git信息" aria-hidden="true" class="header-anchor">#</a> 91.2生成Git信息</h3> <p>Maven和Gradle都允许生成一个git.properties文件，其中包含有关构建项目时git源代码存储库状态的信息。</p> <p>对于Maven用户，spring-boot-starter-parent POM包含一个预先配置的插件，用于生成git.properties文件。 要使用它，请将以下声明添加到POM：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>pl.project13.maven<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>git-commit-id-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Gradle用户可以通过使用Gradle -git-properties插件来达到同样的效果，如下面的例子所示:</p> <div class="language- extra-class"><pre class="language-text"><code>plugins {
	id &quot;com.gorylenko.gradle-git-properties&quot; version &quot;1.5.1&quot;
}
</code></pre></div><blockquote><p>git.properties中的提交时间应符合以下格式：yyyy-MM-dd'T'HH：mm：ssZ。 这是上面列出的两个插件的默认格式。 使用此格式可以将时间解析为日期及其格式，在序列化为JSON时，由Jackson的日期序列化配置设置控制。</p></blockquote> <h3 id="_91-3自定义依赖版本"><a href="#_91-3自定义依赖版本" aria-hidden="true" class="header-anchor">#</a> 91.3自定义依赖版本</h3> <p>如果您使用直接或间接从spring-boot-dependencies（例如，spring-boot-starter-parent）继承的Maven构建，但是您想要覆盖特定的第三方依赖项，则可以添加适当的<code>&lt;properties&gt;</code>元素。 浏览spring-boot-dependencies POM以获取完整的属性列表。 例如，要选择不同的slf4j版本，您需要添加以下属性：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;properties&gt;
	&lt;slf4j.version&gt;1.7.5&lt;slf4j.version&gt;
&lt;/properties&gt;
</code></pre></div><blockquote><p>[注意]
这样做只有在Maven项目从spring-boot-dependencies（直接或间接）继承时才有效。 如果在自己的dependencyManagement部分中使用<code>&lt;scope&gt;</code> import <code>&lt;/scope&gt;</code>添加了spring-boot-dependencies，则必须自己重新定义工件而不是覆盖该属性。</p></blockquote> <blockquote><p>[警告]
每个Spring Boot版本都是针对这组特定的第三方依赖项进行设计和测试的。 覆盖版本可能会导致兼容性问题。</p></blockquote> <p>要在Gradle中覆盖依赖项版本，请参阅Gradle插件文档的此部分。</p> <h3 id="_91-4使用maven创建可执行jar"><a href="#_91-4使用maven创建可执行jar" aria-hidden="true" class="header-anchor">#</a> 91.4使用Maven创建可执行JAR</h3> <p>spring-boot-maven-plugin可用于创建可执行的“胖”JAR。 如果你使用spring-boot-starter-parent POM，你可以声明插件，你的jar重新打包如下：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>如果您不使用父POM，您仍然可以使用该插件。 但是，您还必须添加<code>&lt;executions&gt;</code>部分，如下所示：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.1.3.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executions</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>execution</span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goals</span><span class="token punctuation">&gt;</span></span>
						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goal</span><span class="token punctuation">&gt;</span></span>repackage<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goal</span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goals</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>execution</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executions</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>有关完整的使用详细信息，请参阅插件文档。</p> <h3 id="_91-5使用spring-boot应用程序作为依赖项"><a href="#_91-5使用spring-boot应用程序作为依赖项" aria-hidden="true" class="header-anchor">#</a> 91.5使用Spring Boot应用程序作为依赖项</h3> <p>与war文件一样，Spring Boot应用程序不能用作依赖项。如果您的应用程序包含要与其他项目共享的类，建议的方法是将该代码移动到单独的模块中。然后，您的应用程序和其他项目可以依赖单独的模块。</p> <p>如果您不能按照上面的建议重新安排代码，则必须配置Spring Boot的Maven和Gradle插件，以生成适合用作依赖项的单独工件。可执行存档不能用作依赖项，因为可执行jar格式打包BOOT-INF / classes中的应用程序类。这意味着当可执行jar用作依赖项时，无法找到它们。</p> <p>要生成两个工件，一个可以用作依赖项，另一个可执行，必须指定一个分类器。此分类器应用于可执行归档的名称，保留默认归档以用作依赖项。</p> <p>要在Maven中配置exec的分类器，可以使用以下配置：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>classifier</span><span class="token punctuation">&gt;</span></span>exec<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>classifier</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_91-6可执行jar运行时提取特定库"><a href="#_91-6可执行jar运行时提取特定库" aria-hidden="true" class="header-anchor">#</a> 91.6可执行jar运行时提取特定库</h3> <p>可执行jar中的大多数嵌套库不需要解压缩才能运行。 但是，某些库可能存在问题。 例如，JRuby包含自己的嵌套jar支持，它假定jruby-complete.jar总是直接作为文件直接使用。</p> <p>要处理任何有问题的库，您可以标记在可执行jar首次运行时应该自动解压缩特定的嵌套jar。 这些嵌套的jar文件写在java.io.tmpdir系统属性标识的临时目录下。</p> <blockquote><p>[警告]
应注意确保配置操作系统，以便在应用程序仍在运行时不会删除已解压缩到临时目录的jar。</p></blockquote> <p>例如，要指示应使用Maven插件标记JRuby以进行解包，您将添加以下配置：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>requiresUnpack</span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.jruby<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jruby-complete<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>requiresUnpack</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_91-7使用排除项创建不可执行的jar"><a href="#_91-7使用排除项创建不可执行的jar" aria-hidden="true" class="header-anchor">#</a> 91.7使用排除项创建不可执行的JAR</h3> <p>通常，如果您将可执行文件和非可执行jar作为两个单独的构建产品，则可执行版本具有库jar中不需要的其他配置文件。 例如，application.yml配置文件可能从非可执行JAR中排除。</p> <p>在Maven中，可执行jar必须是主要工件，您可以为库添加一个分类jar，如下所示：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>maven-jar-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executions</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>execution</span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>lib<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>phase</span><span class="token punctuation">&gt;</span></span>package<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>phase</span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goals</span><span class="token punctuation">&gt;</span></span>
						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goal</span><span class="token punctuation">&gt;</span></span>jar<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goal</span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goals</span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>classifier</span><span class="token punctuation">&gt;</span></span>lib<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>classifier</span><span class="token punctuation">&gt;</span></span>
						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>excludes</span><span class="token punctuation">&gt;</span></span>
							<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclude</span><span class="token punctuation">&gt;</span></span>application.yml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclude</span><span class="token punctuation">&gt;</span></span>
						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>excludes</span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>execution</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executions</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_91-8从maven开始远程调试spring-boot应用程序"><a href="#_91-8从maven开始远程调试spring-boot应用程序" aria-hidden="true" class="header-anchor">#</a> 91.8从Maven开始远程调试Spring Boot应用程序</h3> <p>要将远程调试器附加到使用Maven启动的Spring Boot应用程序，您可以使用maven插件的jvmArguments属性。</p> <p>有关详细信息，请参阅此示例。</p> <h3 id="_91-9在不使用spring-boot-antlib的情况下从ant构建可执行文件"><a href="#_91-9在不使用spring-boot-antlib的情况下从ant构建可执行文件" aria-hidden="true" class="header-anchor">#</a> 91.9在不使用spring-boot-antlib的情况下从Ant构建可执行文件</h3> <p>要使用Ant构建，您需要获取依赖项，编译，然后创建jar或war存档。要使其可执行，您可以使用spring-boot-antlib模块，也可以按照以下说明操作：</p> <ol><li>如果要构建jar，请将应用程序的类和资源打包到嵌套的BOOT-INF / classes目录中。如果要构建war，请像往常一样将应用程序的类打包在嵌套的WEB-INF / classes目录中。</li> <li>在嵌套的BOOT-INF / lib目录中为jar或WEB-INF / lib添加运行时依赖项以进行war。切记不要压缩存档中的条目。</li> <li>将提供的（嵌入式容器）依赖项添加到嵌套的BOOT-INF / lib目录中，用于jar或为战争提供的WEB-INF / lib。切记不要压缩存档中的条目。</li> <li>在归档的根目录中添加spring-boot-loader类（以便Main-Class可用）。</li> <li>使用适当的启动程序（例如jar文件的JarLauncher）作为清单中的Main-Class属性，并指定其作为清单条目所需的其他属性 - 主要通过设置Start-Class属性。</li></ol> <p>以下示例显示如何使用Ant构建可执行存档：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>target</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>build<span class="token punctuation">&quot;</span></span> <span class="token attr-name">depends</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>compile<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jar</span> <span class="token attr-name">destfile</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>target/${ant.project.name}-${spring-boot.version}.jar<span class="token punctuation">&quot;</span></span> <span class="token attr-name">compress</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappedresources</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileset</span> <span class="token attr-name">dir</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>target/classes<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>globmapper</span> <span class="token attr-name">from</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>*<span class="token punctuation">&quot;</span></span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>BOOT-INF/classes/*<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappedresources</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappedresources</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileset</span> <span class="token attr-name">dir</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>src/main/resources<span class="token punctuation">&quot;</span></span> <span class="token attr-name">erroronmissingdir</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>globmapper</span> <span class="token attr-name">from</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>*<span class="token punctuation">&quot;</span></span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>BOOT-INF/classes/*<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappedresources</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappedresources</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileset</span> <span class="token attr-name">dir</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>${lib.dir}/runtime<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>globmapper</span> <span class="token attr-name">from</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>*<span class="token punctuation">&quot;</span></span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>BOOT-INF/lib/*<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappedresources</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>zipfileset</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>${lib.dir}/loader/spring-boot-loader-jar-${spring-boot.version}.jar<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>manifest</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>attribute</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Main-Class<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>org.springframework.boot.loader.JarLauncher<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>attribute</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Start-Class<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>${start-class}<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>manifest</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jar</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>target</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Ant示例有一个build.xml文件和一个手动任务，如果您使用以下命令运行该文件，它应该可以工作:</p> <div class="language- extra-class"><pre class="language-text"><code>$ ant -lib &lt;folder containing ivy-2.2.jar&gt; clean manual
</code></pre></div><p>然后你可以用以下命令运行应用程序:</p> <div class="language- extra-class"><pre class="language-text"><code>$ java -jar target/*.jar
</code></pre></div><h2 id="_92-传统部署"><a href="#_92-传统部署" aria-hidden="true" class="header-anchor">#</a> 92.传统部署</h2> <p>Spring Boot支持传统部署以及更现代的部署形式。 本节回答有关传统部署的常见问题。</p> <h3 id="_92-1创建可部署的war文件"><a href="#_92-1创建可部署的war文件" aria-hidden="true" class="header-anchor">#</a> 92.1创建可部署的war文件</h3> <blockquote><p>[警告]
由于Spring WebFlux并不严格依赖于Servlet API，并且默认情况下会在嵌入式Reactor Netty服务器上部署应用程序，因此WebFlux应用程序不支持War部署。</p></blockquote> <p>生成可部署war文件的第一步是提供SpringBootServletInitializer子类并覆盖其configure方法。 这样做可以利用Spring Framework的Servlet 3.0支持，并允许您在servlet容器启动时配置应用程序。 通常，您应该更新应用程序的主类以扩展SpringBootServletInitializer，如以下示例所示：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token keyword">extends</span> <span class="token class-name">SpringBootServletInitializer</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">protected</span> <span class="token class-name">SpringApplicationBuilder</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">SpringApplicationBuilder</span> application<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> application<span class="token punctuation">.</span><span class="token function">sources</span><span class="token punctuation">(</span><span class="token class-name">Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>下一步是更新构建配置，使项目生成war文件而不是jar文件。如果您使用Maven和spring-boot-starter-parent(它为您配置Maven的war插件)，您只需修改pom.xml将包装更改为war，如下所示:</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;packaging&gt;war&lt;/packaging&gt;
</code></pre></div><p>如果使用Gradle，则需要修改build。gradle将war插件应用到项目中，如下:</p> <div class="language- extra-class"><pre class="language-text"><code>apply plugin: 'war'
</code></pre></div><p>该过程的最后一步是确保嵌入式servlet容器不会干扰部署war文件的servlet容器。 为此，您需要将嵌入式servlet容器依赖项标记为已提供。</p> <p>如果您使用Maven，以下示例将servlet容器（在本例中为Tomcat）标记为提供：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
	<span class="token comment">&lt;!-- … --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-tomcat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>provided<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token comment">&lt;!-- … --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>如果使用Gradle，则以下示例将servlet容器（在本例中为Tomcat）标记为提供：</p> <div class="language- extra-class"><pre class="language-text"><code>dependencies {
	// …
	providedRuntime 'org.springframework.boot:spring-boot-starter-tomcat'
	// …
}
</code></pre></div><blockquote><p>providedRuntime比Gradle的compileOnly配置更受欢迎。 除了其他限制之外，compileOnly依赖项不在测试类路径上，因此任何基于Web的集成测试都会失败。</p></blockquote> <p>如果使用Spring Boot构建工具，则标记所提供的嵌入式servlet容器依赖项将生成一个可执行war文件，其中提供的依赖项打包在lib提供的目录中。 这意味着，除了可部署到servlet容器之外，还可以在命令行上使用java -jar运行应用程序。</p> <blockquote><p>查看Spring Boot的示例应用程序，了解基于Maven的先前配置示例。</p></blockquote> <h3 id="_92-2将现有应用程序转换为spring-boot"><a href="#_92-2将现有应用程序转换为spring-boot" aria-hidden="true" class="header-anchor">#</a> 92.2将现有应用程序转换为Spring Boot</h3> <p>对于非Web应用程序，应该很容易将现有的Spring应用程序转换为Spring Boot应用程序。 为此，请丢弃创建ApplicationContext的代码，并将其替换为对SpringApplication或SpringApplicationBuilder的调用。 Spring MVC Web应用程序通常可以首先创建可部署的war应用程序，然后再将其迁移到可执行的war或jar。 请参阅将jar转换为战争的入门指南。</p> <p>要通过扩展SpringBootServletInitializer（例如，在名为Application的类中）并添加Spring Boot @SpringBootApplication批注来创建可部署的war，请使用类似于以下示例中所示的代码：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token keyword">extends</span> <span class="token class-name">SpringBootServletInitializer</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">protected</span> <span class="token class-name">SpringApplicationBuilder</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">SpringApplicationBuilder</span> application<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// Customize the application or call application.sources(...) to add sources</span>
		<span class="token comment">// Since our example is itself a @Configuration class (via @SpringBootApplication)</span>
		<span class="token comment">// we actually don't need to override this method.</span>
		<span class="token keyword">return</span> application<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>请记住，无论你在源代码中添加什么，都只是一个Spring ApplicationContext。通常，任何已经有效的东西都应该在这里工作。可能有一些bean可以在以后删除，让Spring Boot为它们提供自己的默认值，但应该可以在需要之前获得一些工作。</p> <p>静态资源可以移动到类路径根目录中的/ public（或/ static或/ resources或/ META-INF / resources）。这同样适用于messages.properties（Spring Boot会自动在类路径的根中检测到）。</p> <p>Spring DispatcherServlet和Spring Security的Vanilla使用不需要进一步更改。如果应用程序中有其他功能（例如，使用其他servlet或过滤器），则可能需要通过从web.xml替换这些元素，将一些配置添加到Application上下文，如下所示：</p> <ul><li>类型为Servlet或ServletRegistrationBean的@Bean将该bean安装在容器中，就好像它是web.xml中的<servlet></servlet>和<servlet-mapping></servlet-mapping>一样。</li> <li>类型为Filter或FilterRegistrationBean的@Bean的行为类似（作为<filter></filter>和<filter-mapping></filter-mapping>）。</li> <li>可以通过Application中的@ImportResource添加XML文件中的ApplicationContext。或者，已经大量使用注释配置的简单情况可以在几行中重新创建为@Bean定义。</li></ul> <p>一旦war文件正常工作，您可以通过向Application添加main方法使其可执行，如以下示例所示：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>如果您打算将您的应用程序作为war或可执行应用程序启动，您需要在SpringBootServletInitializer回调函数可用的方法中共享构建器的自定义，并在类似于下面的类的主方法中共享:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token keyword">extends</span> <span class="token class-name">SpringBootServletInitializer</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">protected</span> <span class="token class-name">SpringApplicationBuilder</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">SpringApplicationBuilder</span> builder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token function">configureApplication</span><span class="token punctuation">(</span>builder<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">configureApplication</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SpringApplicationBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">SpringApplicationBuilder</span> <span class="token function">configureApplication</span><span class="token punctuation">(</span><span class="token class-name">SpringApplicationBuilder</span> builder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">sources</span><span class="token punctuation">(</span><span class="token class-name">Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bannerMode</span><span class="token punctuation">(</span><span class="token class-name">Banner</span><span class="token punctuation">.</span><span class="token class-name">Mode</span><span class="token punctuation">.</span>OFF<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div></blockquote> <p>应用程序可以分为多个类别：</p> <ul><li>没有web.xml的Servlet 3.0+应用程序。</li> <li>带有web.xml的应用程序。</li> <li>具有上下文层次结构的应用</li> <li>没有上下文层次结构的应用</li></ul> <p>所有这些都应该适合翻译，但每种都可能需要稍微不同的技术。</p> <p>如果Servlet 3.0+应用程序已经使用了Spring Servlet 3.0+初始化程序支持类，那么它们可能很容易翻译。通常，现有WebApplicationInitializer中的所有代码都可以移动到SpringBootServletInitializer中。如果现有应用程序具有多个ApplicationContext（例如，如果它使用AbstractDispatcherServletInitializer），那么您可以将所有上下文源组合到单个SpringApplication中。您可能遇到的主要复杂情况是，如果组合不起作用，您需要维护上下文层次结构。有关示例，请参阅构建层次结构的条目。通常需要拆分包含特定于Web的功能的现有父上下文，以便所有ServletContextAware组件都位于子上下文中。</p> <p>尚未安装Spring应用程序的应用程序可以转换为Spring Boot应用程序，前面提到的指南可能有所帮助。但是，您可能会遇到问题。在这种情况下，我们建议使用spring-boot标记在Stack Overflow上提问。</p> <h3 id="_92-3将war部署到weblogic"><a href="#_92-3将war部署到weblogic" aria-hidden="true" class="header-anchor">#</a> 92.3将WAR部署到WebLogic</h3> <p>要将Spring Boot应用程序部署到WebLogic，必须确保servlet初始化程序直接实现WebApplicationInitializer（即使从已实现它的基类扩展）。</p> <p>WebLogic的典型初始化程序应类似于以下示例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure</span><span class="token punctuation">.</span><span class="token class-name">SpringBootApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>support</span><span class="token punctuation">.</span><span class="token class-name">SpringBootServletInitializer</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web</span><span class="token punctuation">.</span><span class="token class-name">WebApplicationInitializer</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyApplication</span> <span class="token keyword">extends</span> <span class="token class-name">SpringBootServletInitializer</span> <span class="token keyword">implements</span> <span class="token class-name">WebApplicationInitializer</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre></div><p>如果使用Logback，则还需要告知WebLogic更喜欢打包版本而不是服务器预安装的版本。 您可以通过添加包含以下内容的WEB-INF / weblogic.xml文件来完成此操作：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">wls:</span>weblogic-web-app</span>
	<span class="token attr-name"><span class="token namespace">xmlns:</span>wls</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://xmlns.oracle.com/weblogic/weblogic-web-app<span class="token punctuation">&quot;</span></span>
	<span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
	<span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>http://java.sun.com/xml/ns/javaee
		http://java.sun.com/xml/ns/javaee/ejb-jar_3_0.xsd
		http://xmlns.oracle.com/weblogic/weblogic-web-app
		http://xmlns.oracle.com/weblogic/weblogic-web-app/1.4/weblogic-web-app.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">wls:</span>container-descriptor</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">wls:</span>prefer-application-packages</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">wls:</span>package-name</span><span class="token punctuation">&gt;</span></span>org.slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">wls:</span>package-name</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">wls:</span>prefer-application-packages</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">wls:</span>container-descriptor</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">wls:</span>weblogic-web-app</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_92-4使用jedis代替lettuce"><a href="#_92-4使用jedis代替lettuce" aria-hidden="true" class="header-anchor">#</a> 92.4使用Jedis代替Lettuce</h3> <p>默认情况下，Spring Boot启动程序（spring-boot-starter-data-redis）使用Lettuce。 您需要排除该依赖项并改为包含Jedis。 Spring Boot管理这些依赖项，以帮助使这个过程尽可能简单。</p> <p>以下示例显示了如何在Maven中执行此操作：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.lettuce<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lettuce-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>redis.clients<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jedis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>下面的例子展示了如何在Gradle中做到这一点:</p> <div class="language- extra-class"><pre class="language-text"><code>configurations {
	compile.exclude module: &quot;lettuce&quot;
}

dependencies {
	compile(&quot;redis.clients:jedis&quot;)
	// ...
}
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/SpringBoot/8.html" class="prev">
          第八部分.构建工具插件
        </a></span> <span class="next"><a href="/SpringBoot/10.html">
          十.附录部分
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.6b6e86e7.js" defer></script><script src="/assets/js/15.1fd61ce8.js" defer></script>
  </body>
</html>
