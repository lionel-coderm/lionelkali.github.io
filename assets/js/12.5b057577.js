(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{185:function(t,e,a){"use strict";a.r(e);var n=a(0),s=Object(n.a)({},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),a("p",[t._v("在部署应用程序时，Spring Boot的灵活打包选项提供了大量的选择。您可以将SpringBoot应用程序部署到各种云平台、容器映像(如Docker)或虚拟/真实机器。")]),t._v(" "),a("p",[t._v("本节将介绍一些更常见的部署场景。")]),t._v(" "),t._m(1),t._v(" "),a("p",[t._v("Spring Boot的可执行jar是为大多数流行的云PaaS(平台即服务)提供者准备的。这些提供者往往要求您“自带容器”。它们管理应用程序流程(不是特定的Java应用程序)，因此它们需要一个中间层，使您的应用程序适应云的运行流程概念。")]),t._v(" "),a("p",[t._v("两个流行的云提供商Heroku和cloud Foundry采用了一种“构建包”方法。buildpack将部署的代码封装在启动应用程序所需的任何内容中。它可能是JDK和对java的调用、嵌入式web服务器或功能齐全的应用程序服务器。构建包是可插拔的，但理想情况下，您应该能够通过对其进行尽可能少的定制。这减少了不在您控制之下的功能的占用空间。它最小化了开发环境和生产环境之间的差异。")]),t._v(" "),a("p",[t._v("理想情况下，您的应用程序就像Spring Boot可执行jar一样，包含了运行所需的所有内容。")]),t._v(" "),a("p",[t._v("在本节中，我们将了解如何使我们在“入门”小节中开发的简单应用程序在云中运行。")]),t._v(" "),t._m(2),t._v(" "),a("p",[t._v("Cloud Foundry提供了默认的构建包，如果没有指定其他构建包，这些构建包就会发挥作用。Cloud Foundry Java buildpack对Spring应用程序(包括Spring Boot)提供了出色的支持。您可以部署独立的可执行jar应用程序，也可以部署传统的.war打包应用程序。")]),t._v(" "),a("p",[t._v("构建应用程序（例如，使用mvn clean package）并安装cf命令行工具后，使用cf push命令部署应用程序，将路径替换为已编译的.jar。 在推送应用程序之前，请务必使用cf命令行客户端登录。 以下行显示使用cf push命令部署应用程序：")]),t._v(" "),t._m(3),t._m(4),t._v(" "),a("p",[t._v("有关更多选项，请参阅cf push文档。如果有云计算清单。如果同一目录中存在Cloud Foundry manifest.yml文件，则会考虑该文件。")]),t._v(" "),a("p",[t._v("此时，cf开始上传您的应用程序，生成类似于以下示例的输出：")]),t._v(" "),t._m(5),a("p",[t._v("恭喜！ 该应用程序现已上线！")]),t._v(" "),a("p",[t._v("应用程序启动后，您可以使用cf apps命令验证已部署应用程序的状态，如以下示例所示：")]),t._v(" "),t._m(6),a("p",[t._v("一旦Cloud Foundry确认您的应用程序已部署，您应该能够在给定的URI处找到该应用程序。 在前面的示例中，您可以在http://acloudyspringtime.cfapps.io/找到它。")]),t._v(" "),t._m(7),t._v(" "),a("p",[t._v("默认情况下，有关正在运行的应用程序的元数据以及服务连接信息将作为环境变量公开给应用程序（例如：$ VCAP_SERVICES）。 此体系结构决策归功于Cloud Foundry的多语言（任何语言和平台都可以作为buildpack支持）。 进程范围的环境变量与语言无关。")]),t._v(" "),a("p",[t._v("环境变量并不总是适用于最简单的API，因此Spring Boot会自动提取它们并将数据展平为可通过Spring的Environment抽象访问的属性，如以下示例所示：")]),t._v(" "),t._m(8),a("p",[t._v("所有Cloud Foundry属性都以vcap为前缀。 您可以使用vcap属性来访问应用程序信息（例如应用程序的公共URL）和服务信息（例如数据库凭据）。 有关完整的详细信息，请参阅“CloudFoundryVcapEnvironmentPostProcessor”Javadoc。")]),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),a("p",[t._v("Heroku是另一个流行的PaaS平台。 要自定义Heroku构建，请提供Procfile，它提供部署应用程序所需的咒语。 Heroku为Java应用程序分配一个端口，然后确保路由到外部URI。")]),t._v(" "),a("p",[t._v("您必须将应用程序配置为侦听正确的端口。 以下示例显示了启动REST应用程序的Procfile：")]),t._v(" "),t._m(11),a("p",[t._v("Spring Boot使-D参数可用作可从Spring Environment实例访问的属性。 server.port配置属性被提供给嵌入式Tomcat，Jetty或Undertow实例，然后在启动时使用该端口。 $ PORT环境变量由Heroku PaaS分配给我们。")]),t._v(" "),a("p",[t._v("这应该是你需要的一切。 Heroku部署最常见的部署工作流是将代码推送到生产环境，如以下示例所示：")]),t._v(" "),t._m(12),t._m(13),t._v(" "),a("p",[t._v("OpenShift是Kubernetes容器编排平台的Red Hat公共（和企业）扩展。 与Kubernetes类似，OpenShift有许多选项可用于安装基于Spring Boot的应用程序。")]),t._v(" "),a("p",[t._v("OpenShift有许多资源描述如何部署Spring Boot应用程序，包括：")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://blog.openshift.com/using-openshift-enterprise-grade-spring-boot-deployments/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Using the S2I builder"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://access.redhat.com/documentation/en-us/reference_architectures/2017/html-single/spring_boot_microservices_on_red_hat_openshift_container_platform_3/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Architecture guide"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://blog.openshift.com/using-spring-boot-on-openshift/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Running as a traditional web application on Wildfly"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://blog.openshift.com/openshift-commons-briefing-96-cloud-native-applications-spring-rhoar/",target:"_blank",rel:"noopener noreferrer"}},[t._v("OpenShift Commons Briefing"),a("OutboundLink")],1)])]),t._v(" "),t._m(14),t._v(" "),a("p",[t._v("Amazon Web Services提供了多种方法来安装基于Spring Boot的应用程序，既可以作为传统的Web应用程序（战争），也可以作为带有嵌入式Web服务器的可执行jar文件。 选项包括：")]),t._v(" "),t._m(15),t._v(" "),a("p",[t._v("每一个都有不同的特性和定价模型。在本文中，我们只描述了最简单的选项:AWS Elastic Beanstalk。")]),t._v(" "),t._m(16),t._v(" "),a("p",[t._v("如官方Elastic Beanstalk Java指南中所述，部署Java应用程序有两个主要选项。 您可以使用“Tomcat平台”或“Java SE平台”。")]),t._v(" "),t._m(17),t._v(" "),a("p",[t._v("此选项适用于生成war文件的SpringBoot项目。不需要特殊配置。你只需要遵循官方指南。")]),t._v(" "),t._m(18),t._v(" "),a("p",[t._v("此选项适用于生成jar文件并运行嵌入式Web容器的Spring Boot项目。 Elastic Beanstalk环境在端口80上运行nginx实例以代理在端口5000上运行的实际应用程序。要配置它，请将以下行添加到application.properties文件中：")]),t._v(" "),t._m(19),t._m(20),t._v(" "),t._m(21),t._v(" "),t._m(22),t._v(" "),a("p",[t._v("这是访问AWS的最简单方法之一，但还有更多内容需要涉及，例如如何将Elastic Beanstalk集成到任何CI / CD工具中，使用Elastic Beanstalk Maven插件而不是CLI等。 有一篇"),a("a",{attrs:{href:"https://exampledriven.wordpress.com/2017/01/09/spring-boot-aws-elastic-beanstalk-example/",target:"_blank",rel:"noopener noreferrer"}},[t._v("博文"),a("OutboundLink")],1),t._v("更详细地介绍了这些主题。")]),t._v(" "),t._m(23),t._v(" "),a("p",[t._v("Boxfuse的工作原理是将Spring Boot可执行jar或war转换为可在VirtualBox或AWS上无需部署的最小VM映像。 Boxfuse带有Spring Boot的深度集成，并使用Spring Boot配置文件中的信息自动配置端口和运行状况检查URL。 Boxfuse利用这些信息来处理它产生的图像以及它提供的所有资源（实例，安全组，弹性负载平衡器等）。")]),t._v(" "),a("p",[t._v("创建Boxfuse帐户后，将其连接到您的AWS账户，安装最新版本的Boxfuse Client，并确保该应用程序已由Maven或Gradle构建（例如，使用mvn clean package），您可以 使用类似于以下的命令将Spring Boot应用程序部署到AWS：")]),t._v(" "),t._m(24),a("p",[t._v("有关更多选项，请参阅boxfuse运行文档。如果当前目录中存在boxfuse.conf文件，则考虑它。")]),t._v(" "),t._m(25),t._v(" "),a("p",[t._v("此时，boxfuse为您的应用程序创建一个映像，上传它，并在AWS上配置和启动必要的资源，从而产生类似于以下示例的输出：")]),t._v(" "),t._m(26),a("p",[t._v("您的应用程序现在应该在AWS上启动并运行。")]),t._v(" "),a("p",[t._v("请参阅有关在EC2上部署Spring Boot应用程序的博客文章以及Boxfuse Spring Boot集成的文档，以开始使用Maven构建来运行应用程序。")]),t._v(" "),t._m(27),t._v(" "),a("p",[t._v("Google Cloud有几个可用于启动Spring Boot应用程序的选项。 最容易上手的可能是App Engine，但您也可以找到在带有Container Engine的容器中运行Spring Boot的方法，或者在具有Compute Engine的虚拟机上运行Spring Boot的方法。")]),t._v(" "),a("p",[t._v("要在App Engine中运行，您可以首先在UI中创建项目，该项目为您设置唯一标识符并设置HTTP路由。 将Java应用程序添加到项目中并将其留空，然后使用Google Cloud SDK将Spring Boot应用程序从命令行或CI构建推送到该插槽。")]),t._v(" "),a("p",[t._v("App Engine Standard要求您使用WAR包装。 按照以下步骤将App Engine Standard应用程序部署到Google Cloud。")]),t._v(" "),a("p",[t._v("或者，App Engine Flex要求您创建app.yaml文件以描述您的应用所需的资源。 通常，您将此文件放在src / main / appengine中，它应该类似于以下文件：")]),t._v(" "),t._m(28),a("p",[t._v("您可以通过将项目ID添加到构建配置来部署应用程序（例如，使用Maven插件），如以下示例所示：")]),t._v(" "),t._m(29),a("p",[t._v("然后使用mvn appengine：deploy进行部署（如果需要先进行身份验证，则构建失败）。")]),t._v(" "),t._m(30),t._v(" "),a("p",[t._v("除了使用java -jar运行Spring Boot应用程序之外，还可以为Unix系统创建完全可执行的应用程序。 完全可执行的jar可以像任何其他可执行二进制文件一样执行，也可以使用init.d或systemd注册。 这使得在常见的生产环境中安装和管理Spring Boot应用程序变得非常容易。")]),t._v(" "),t._m(31),a("p",[t._v("要使用Maven创建“完全可执行”jar，请使用以下插件配置：")]),t._v(" "),t._m(32),a("p",[t._v("下面的例子展示了等效的Gradle配置:")]),t._v(" "),t._m(33),a("p",[t._v("然后，您可以通过键入./my-application.jar（其中my-application是您的工件的名称）来运行您的应用程序。 包含jar的目录用作应用程序的工作目录。")]),t._v(" "),t._m(34),t._v(" "),a("p",[t._v("默认脚本支持大多数Linux发行版，并在CentOS和Ubuntu上进行测试。 其他平台，如OS X和FreeBSD，需要使用自定义embeddedLaunchScript。")]),t._v(" "),t._m(35),t._v(" "),a("p",[t._v("通过使用init.d或systemd，可以轻松地将Spring Boot应用程序作为Unix / Linux服务启动。")]),t._v(" "),t._m(36),t._v(" "),a("p",[t._v("如果您配置了Spring Boot的Maven或Gradle插件来生成完全可执行的jar，并且您没有使用自定义embeddedLaunchScript，那么您的应用程序可以用作init.d服务。 为此，请将jar符号链接到init.d以支持标准的启动，停止，重新启动和状态命令。")]),t._v(" "),a("p",[t._v("该脚本支持以下功能：")]),t._v(" "),t._m(37),t._v(" "),a("p",[t._v("假设您在/ var / myapp中安装了Spring Boot应用程序，要将Spring Boot应用程序安装为init.d服务，请创建符号链接，如下所示：")]),t._v(" "),t._m(38),a("p",[t._v("安装后，您可以按常规方式启动和停止服务。 例如，在基于Debian的系统上，您可以使用以下命令启动它：")]),t._v(" "),t._m(39),t._m(40),t._v(" "),a("p",[t._v("您还可以使用标准操作系统工具将应用程序标记为自动启动。 例如，在Debian上，您可以使用以下命令：")]),t._v(" "),t._m(41),t._m(42),t._v(" "),t._m(43),t._v(" "),a("p",[t._v("当以root身份执行时，就像root用于启动init.d服务的情况一样，默认可执行脚本以拥有jar文件的用户身份运行应用程序。 您永远不应该以root身份运行Spring Boot应用程序，因此应用程序的jar文件永远不应该由root拥有。 相反，创建一个特定用户来运行您的应用程序并使用chown使其成为jar文件的所有者，如以下示例所示：")]),t._v(" "),t._m(44),a("p",[t._v("在本例中，默认的可执行脚本作为bootapp用户运行应用程序。")]),t._v(" "),t._m(45),t._v(" "),a("p",[t._v("您还应该采取措施来防止修改应用程序的jar文件。 首先，配置其权限，使其无法编写，只能由其所有者读取或执行，如以下示例所示：")]),t._v(" "),t._m(46),a("p",[t._v("其次，如果您的应用程序或运行它的帐户受到损害，您还应该采取措施限制损害。 如果攻击者确实获得了访问权限，他们可以使jar文件可写并更改其内容。 防止这种情况的一种方法是使用chattr使其不可变，如以下示例所示：")]),t._v(" "),t._m(47),a("p",[t._v("这将阻止任何用户（包括root）修改jar。")]),t._v(" "),a("p",[t._v("如果root用于控制应用程序的服务，并且您使用.conf文件来自定义其启动，则root用户将读取并评估.conf文件。 它应该得到相应的保护。 使用chmod以便文件只能由所有者读取并使用chown使root成为所有者，如以下示例所示：")]),t._v(" "),t._m(48),t._m(49),t._v(" "),a("p",[t._v("systemd是System V init系统的后继产品，现在被许多现代Linux发行版使用。 虽然您可以继续将init.d脚本与systemd一起使用，但也可以使用systemd“service”脚本启动Spring Boot应用程序。")]),t._v(" "),a("p",[t._v("假设您在/ var / myapp中安装了Spring Boot应用程序，要将Spring Boot应用程序安装为systemd服务，请创建名为myapp.service的脚本并将其放在/ etc / systemd / system目录中。 以下脚本提供了一个示例：")]),t._v(" "),t._m(50),t._m(51),t._v(" "),t._m(52),t._v(" "),a("p",[t._v("请注意，与作为init.d服务运行时不同，运行应用程序的用户，PID文件和控制台日志文件由systemd本身管理，因此必须使用“service”脚本中的相应字段进行配置。 有关更多详细信息，请参阅服务单元配置手册页。")]),t._v(" "),a("p",[t._v("要将应用程序标记为在系统引导时自动启动，请使用以下命令：")]),t._v(" "),t._m(53),a("p",[t._v("有关详细信息，请参考man systemctl。")]),t._v(" "),t._m(54),t._v(" "),a("p",[t._v("Maven或Gradle插件编写的默认嵌入式启动脚本可以通过多种方式进行定制。对于大多数人来说，使用默认脚本和一些定制通常就足够了。如果发现无法定制所需的内容，可以使用embeddedLaunchScript选项完全编写自己的文件。")]),t._v(" "),t._m(55),t._v(" "),a("p",[t._v("在将脚本写入jar文件时自定义启动脚本的元素通常是有意义的。 例如，init.d脚本可以提供“描述”。 由于您事先了解了描述（并且无需更改），因此您可以在生成jar时提供它。")]),t._v(" "),a("p",[t._v("要自定义编写的元素，请使用Spring Boot Maven插件的embeddedLaunchScriptProperties选项或Spring Boot Gradle插件的launchScript的properties属性。")]),t._v(" "),a("p",[t._v("默认脚本支持以下属性替换：")]),t._v(" "),t._m(56),t._v(" "),t._m(57),t._v(" "),a("p",[t._v("对于在编写jar后需要自定义的脚本项，可以使用环境变量或配置文件。")]),t._v(" "),a("p",[t._v("默认脚本支持以下环境属性：")]),t._v(" "),t._m(58),t._v(" "),t._m(59),t._v(" "),a("p",[t._v("除JARFILE和APP_NAME外，可以使用.conf文件配置上一节中列出的设置。 该文件应该位于jar文件的旁边，并且具有相同的名称，但后缀为.conf而不是.jar。 例如，名为/var/myapp/myapp.jar的jar使用名为/var/myapp/myapp.conf的配置文件，如以下示例所示：")]),t._v(" "),t._m(60),t._v(" "),t._m(61),t._m(62),t._v(" "),a("p",[t._v("要了解如何适当地保护此文件，请参阅保护init的指南。d服务。")]),t._v(" "),t._m(63),t._v(" "),a("p",[t._v("可以使用winsw将Spring Boot应用程序作为Windows服务启动。")]),t._v(" "),a("p",[t._v("A（单独维护的示例）逐步介绍了如何为Spring Boot应用程序创建Windows服务。")]),t._v(" "),t._m(64),t._v(" "),a("p",[t._v("查看Cloud Foundry，Heroku，OpenShift和Boxfuse网站，了解有关PaaS可提供的各种功能的更多信息。 这些只是四个最受欢迎的Java PaaS提供商。 由于Spring Boot非常适合基于云的部署，因此您也可以自由地考虑其他提供程序。")]),t._v(" "),a("p",[t._v("下一节将介绍Spring Boot CLI，或者您可以继续阅读有关构建工具插件的内容。")])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"第六部分-部署-spring-boot-应用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#第六部分-部署-spring-boot-应用","aria-hidden":"true"}},[this._v("#")]),this._v(" 第六部分.部署 Spring Boot 应用")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"_63-部署到云"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_63-部署到云","aria-hidden":"true"}},[this._v("#")]),this._v(" 63. 部署到云")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_63-1云计算"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_63-1云计算","aria-hidden":"true"}},[this._v("#")]),this._v(" 63.1云计算")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("$ cf push acloudyspringtime -p target/demo-0.0.1-SNAPSHOT.jar\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("在前面的示例中，我们将acloudyspringtime替换为将cf作为应用程序名称的任何值。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("Uploading acloudyspringtime... OK\nPreparing to start acloudyspringtime... OK\n-----\x3e Downloaded app package (8.9M)\n-----\x3e Java Buildpack Version: v3.12 (offline) | https://github.com/cloudfoundry/java-buildpack.git#6f25b7e\n-----\x3e Downloading Open Jdk JRE 1.8.0_121 from https://java-buildpack.cloudfoundry.org/openjdk/trusty/x86_64/openjdk-1.8.0_121.tar.gz (found in cache)\n       Expanding Open Jdk JRE to .java-buildpack/open_jdk_jre (1.6s)\n-----\x3e Downloading Open JDK Like Memory Calculator 2.0.2_RELEASE from https://java-buildpack.cloudfoundry.org/memory-calculator/trusty/x86_64/memory-calculator-2.0.2_RELEASE.tar.gz (found in cache)\n       Memory Settings: -Xss349K -Xmx681574K -XX:MaxMetaspaceSize=104857K -Xms681574K -XX:MetaspaceSize=104857K\n-----\x3e Downloading Container Certificate Trust Store 1.0.0_RELEASE from https://java-buildpack.cloudfoundry.org/container-certificate-trust-store/container-certificate-trust-store-1.0.0_RELEASE.jar (found in cache)\n       Adding certificates to .java-buildpack/container_certificate_trust_store/truststore.jks (0.6s)\n-----\x3e Downloading Spring Auto Reconfiguration 1.10.0_RELEASE from https://java-buildpack.cloudfoundry.org/auto-reconfiguration/auto-reconfiguration-1.10.0_RELEASE.jar (found in cache)\nChecking status of app 'acloudyspringtime'...\n  0 of 1 instances running (1 starting)\n  ...\n  0 of 1 instances running (1 starting)\n  ...\n  0 of 1 instances running (1 starting)\n  ...\n  1 of 1 instances running (1 running)\n\nApp started\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("$ cf apps\nGetting applications in ...\nOK\n\nname                 requested state   instances   memory   disk   urls\n...\nacloudyspringtime    started           1/1         512M     1G     acloudyspringtime.cfapps.io\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"_63-1-1绑定到服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_63-1-1绑定到服务","aria-hidden":"true"}},[this._v("#")]),this._v(" 63.1.1绑定到服务")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Component")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyBean")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EnvironmentAware")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" instanceId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setEnvironment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Environment")]),t._v(" environment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("instanceId "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" environment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vcap.application.instance_id"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("Spring Cloud Connectors项目更适合配置DataSource等任务。 Spring Boot包括自动配置支持和spring-boot-starter-cloud-connectors启动器。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_63-2-heroku"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_63-2-heroku","aria-hidden":"true"}},[this._v("#")]),this._v(" 63.2 Heroku")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("web: java -Dserver.port=$PORT -jar target/demo-0.0.1-SNAPSHOT.jar\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("$ git push heroku master\n\nInitializing repository, done.\nCounting objects: 95, done.\nDelta compression using up to 8 threads.\nCompressing objects: 100% (78/78), done.\nWriting objects: 100% (95/95), 8.66 MiB | 606.00 KiB/s, done.\nTotal 95 (delta 31), reused 0 (delta 0)\n\n-----\x3e Java app detected\n-----\x3e Installing OpenJDK 1.8... done\n-----\x3e Installing Maven 3.3.1... done\n-----\x3e Installing settings.xml... done\n-----\x3e Executing: mvn -B -DskipTests=true clean install\n\n       [INFO] Scanning for projects...\n       Downloading: https://repo.spring.io/...\n       Downloaded: https://repo.spring.io/... (818 B at 1.8 KB/sec)\n\t\t....\n       Downloaded: http://s3pository.heroku.com/jvm/... (152 KB at 595.3 KB/sec)\n       [INFO] Installing /tmp/build_0c35a5d2-a067-4abc-a232-14b1fb7a8229/target/...\n       [INFO] Installing /tmp/build_0c35a5d2-a067-4abc-a232-14b1fb7a8229/pom.xml ...\n       [INFO] ------------------------------------------------------------------------\n       [INFO] BUILD SUCCESS\n       [INFO] ------------------------------------------------------------------------\n       [INFO] Total time: 59.358s\n       [INFO] Finished at: Fri Mar 07 07:28:25 UTC 2014\n       [INFO] Final Memory: 20M/493M\n       [INFO] ------------------------------------------------------------------------\n\n-----\x3e Discovering process types\n       Procfile declares types -> web\n\n-----\x3e Compressing... done, 70.4MB\n-----\x3e Launching... done, v6\n       http://agile-sierra-1405.herokuapp.com/ deployed to Heroku\n\nTo git@heroku.com:agile-sierra-1405.git\n * [new branch]      master -> master\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_63-3-openshift"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_63-3-openshift","aria-hidden":"true"}},[this._v("#")]),this._v(" 63.3 OpenShift")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_63-4-amazon-web-services-aws"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_63-4-amazon-web-services-aws","aria-hidden":"true"}},[this._v("#")]),this._v(" 63.4 Amazon Web Services (AWS)")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",[a("li",[t._v("AWS Elastic Beanstalk")]),t._v(" "),a("li",[t._v("AWS Code Deploy")]),t._v(" "),a("li",[t._v("AWS OPS Works")]),t._v(" "),a("li",[t._v("AWS Cloud Formation")]),t._v(" "),a("li",[t._v("AWS Container Registry")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"_63-4-1-aws-elastic-beanstalk"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_63-4-1-aws-elastic-beanstalk","aria-hidden":"true"}},[this._v("#")]),this._v(" 63.4.1 AWS Elastic Beanstalk")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("使用Tomcat平台")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("使用Java SE平台")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("server.port=5000\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("默认情况下，Elastic Beanstalk上传源并在AWS中编译它们。 但是，最好上传二进制文件。 为此，请在.elasticbeanstalk / config.yml文件中添加类似于以下内容的行：")]),this._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("deploy:\n\tartifact: target/demo-0.0.1-SNAPSHOT.jar\n")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("默认情况下，Elastic Beanstalk环境是负载平衡的。 负载平衡器具有显着的成本。 要避免此成本，请将环境类型设置为“单实例”，如Amazon文档中所述。 您还可以使用CLI和以下命令创建单实例环境：")]),this._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("eb create -s\n")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"_63-4-2总结"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_63-4-2总结","aria-hidden":"true"}},[this._v("#")]),this._v(" 63.4.2总结")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_63-5-boxfuse-and-amazon-web-services"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_63-5-boxfuse-and-amazon-web-services","aria-hidden":"true"}},[this._v("#")]),this._v(" 63.5 Boxfuse and Amazon Web Services")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("$ boxfuse run myapp-1.0.jar -env=prod\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("默认情况下，Boxfuse在启动时激活名为boxfuse的Spring配置文件。 如果您的可执行jar或war包含application-boxfuse.properties文件，Boxfuse将其配置基于它包含的属性。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("Fusing Image for myapp-1.0.jar ...\nImage fused in 00:06.838s (53937 K) -> axelfontaine/myapp:1.0\nCreating axelfontaine/myapp ...\nPushing axelfontaine/myapp:1.0 ...\nVerifying axelfontaine/myapp:1.0 ...\nCreating Elastic IP ...\nMapping myapp-axelfontaine.boxfuse.io to 52.28.233.167 ...\nWaiting for AWS to create an AMI for axelfontaine/myapp:1.0 in eu-central-1 (this may take up to 50 seconds) ...\nAMI created in 00:23.557s -> ami-d23f38cf\nCreating security group boxfuse-sg_axelfontaine/myapp:1.0 ...\nLaunching t2.micro instance of axelfontaine/myapp:1.0 (ami-d23f38cf) in eu-central-1 ...\nInstance launched in 00:30.306s -> i-92ef9f53\nWaiting for AWS to boot Instance i-92ef9f53 and Payload to start at http://52.28.235.61/ ...\nPayload started in 00:29.266s -> http://52.28.235.61/\nRemapping Elastic IP 52.28.233.167 to i-92ef9f53 ...\nWaiting 15s for AWS to complete Elastic IP Zero Downtime transition ...\nDeployment completed successfully. axelfontaine/myapp:1.0 is up and running at http://myapp-axelfontaine.boxfuse.io/\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_63-6-google-cloud"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_63-6-google-cloud","aria-hidden":"true"}},[this._v("#")]),this._v(" 63.6 Google Cloud")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("service: default\n\nruntime: java\nenv: flex\n\nruntime_config:\n  jdk: openjdk8\n\nhandlers:\n- url: /.*\n  script: this field is required, but ignored\n\nmanual_scaling:\n  instances: 1\n\nhealth_check:\n  enable_health_check: False\n\nenv_variables:\n  ENCRYPT_KEY: your_encryption_key_here\n")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("plugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com.google.cloud.tools"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("appengine-maven-plugin"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1.3.0"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("configuration")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("project")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("myproject"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("project")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("configuration")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("plugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"_64-installing-spring-boot-applications"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_64-installing-spring-boot-applications","aria-hidden":"true"}},[this._v("#")]),this._v(" 64. Installing Spring Boot Applications")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("警告\n完全可执行的jar通过在文件的前面嵌入额外的脚本来工作。 目前，某些工具不接受此格式，因此您可能无法始终使用此技术。 例如，jar -xf可能会无声地提取已完全可执行的jar或war。 建议您只有在打算直接执行jar或war时才能使jar或war完全可执行，而不是使用java -jar运行它或将其部署到servlet容器。\n")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("plugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.springframework.boot"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("spring-boot-maven-plugin"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("configuration")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("executable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("true"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("executable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("configuration")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("plugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("bootJar {\n\tlaunchScript()\n}\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_64-1支持的操作系统"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_64-1支持的操作系统","aria-hidden":"true"}},[this._v("#")]),this._v(" 64.1支持的操作系统")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_64-2-unix-linux-services"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_64-2-unix-linux-services","aria-hidden":"true"}},[this._v("#")]),this._v(" 64.2 Unix/Linux Services")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_64-2-1-installation-as-an-init-d-service-system-v"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_64-2-1-installation-as-an-init-d-service-system-v","aria-hidden":"true"}},[this._v("#")]),this._v(" 64.2.1 Installation as an "),e("code",[this._v("init.d")]),this._v(" Service (System V)")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",[a("li",[t._v("以拥有jar文件的用户身份启动服务")]),t._v(" "),a("li",[t._v("使用/var/run/"),a("code",[t._v("<appname>")]),t._v("/"),a("code",[t._v("<appname>")]),t._v(".pid跟踪应用程序的PID")]),t._v(" "),a("li",[t._v("将控制台日志写入/var/log/"),a("code",[t._v("<appname>")]),t._v("n.log")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("$ sudo ln -s /var/myapp/myapp.jar /etc/init.d/myapp\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("$ service myapp start\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("如果您的应用程序无法启动，请检查写入/var/log/"),e("code",[this._v("<appname>")]),this._v(".log的日志文件是否有错误。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("$ update-rc.d myapp defaults <priority>\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("Securing an "),e("code",[this._v("init.d")]),this._v(" Service")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("以下是一组有关如何保护作为init.d服务运行的Spring Boot应用程序的指南。 它并不是为了强化应用程序及其运行环境而应该做的所有事情的详尽列表。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("$ chown bootapp:bootapp your-app.jar\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("为了减少应用程序用户帐户遭到入侵的可能性，您应该考虑阻止它使用登录shell。 例如，您可以将帐户的shell设置为/ usr / sbin / nologin。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("$ chmod 500 your-app.jar\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("$ sudo chattr +i your-app.jar\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("$ chmod 400 your-app.conf\n$ sudo chown root:root your-app.conf\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"_64-2-2安装为systemd服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_64-2-2安装为systemd服务","aria-hidden":"true"}},[this._v("#")]),this._v(" 64.2.2安装为systemd服务")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("[Unit]\nDescription=myapp\nAfter=syslog.target\n\n[Service]\nUser=myapp\nExecStart=/var/myapp/myapp.jar\nSuccessExitStatus=143\n\n[Install]\nWantedBy=multi-user.target\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("重要的")]),this._v(" "),e("p",[this._v("记住，要更改应用程序的Description、User和ExecStart字段。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("ExecStart字段没有声明script action命令，这意味着默认情况下使用run命令。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("$ systemctl enable myapp.service\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"_64-2-3自定义启动脚本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_64-2-3自定义启动脚本","aria-hidden":"true"}},[this._v("#")]),this._v(" 64.2.3自定义启动脚本")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("编写开始脚本时自定义该脚本")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table",[a("thead",[a("tr",[a("th",[t._v("Name")]),t._v(" "),a("th",[t._v("Description")]),t._v(" "),a("th",[t._v("Gradle default")]),t._v(" "),a("th",[t._v("Maven default")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("code",[t._v("mode")])]),t._v(" "),a("td",[t._v("The script mode.")]),t._v(" "),a("td",[a("code",[t._v("auto")])]),t._v(" "),a("td",[a("code",[t._v("auto")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("initInfoProvides")])]),t._v(" "),a("td",[t._v("The "),a("code",[t._v("Provides")]),t._v(" section of “INIT INFO”")]),t._v(" "),a("td",[a("code",[t._v("${task.baseName}")])]),t._v(" "),a("td",[a("code",[t._v("${project.artifactId}")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("initInfoRequiredStart")])]),t._v(" "),a("td",[a("code",[t._v("Required-Start")]),t._v(" section of “INIT INFO”.")]),t._v(" "),a("td",[a("code",[t._v("$remote_fs $syslog $network")])]),t._v(" "),a("td",[a("code",[t._v("$remote_fs $syslog $network")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("initInfoRequiredStop")])]),t._v(" "),a("td",[a("code",[t._v("Required-Stop")]),t._v(" section of “INIT INFO”.")]),t._v(" "),a("td",[a("code",[t._v("$remote_fs $syslog $network")])]),t._v(" "),a("td",[a("code",[t._v("$remote_fs $syslog $network")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("initInfoDefaultStart")])]),t._v(" "),a("td",[a("code",[t._v("Default-Start")]),t._v(" section of “INIT INFO”.")]),t._v(" "),a("td",[a("code",[t._v("2 3 4 5")])]),t._v(" "),a("td",[a("code",[t._v("2 3 4 5")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("initInfoDefaultStop")])]),t._v(" "),a("td",[a("code",[t._v("Default-Stop")]),t._v(" section of “INIT INFO”.")]),t._v(" "),a("td",[a("code",[t._v("0 1 6")])]),t._v(" "),a("td",[a("code",[t._v("0 1 6")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("initInfoShortDescription")])]),t._v(" "),a("td",[a("code",[t._v("Short-Description")]),t._v(" section of “INIT INFO”.")]),t._v(" "),a("td",[t._v("Single-line version of "),a("code",[t._v("${project.description}")]),t._v("(falling back to "),a("code",[t._v("${task.baseName}")]),t._v(")")]),t._v(" "),a("td",[a("code",[t._v("${project.name}")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("initInfoDescription")])]),t._v(" "),a("td",[a("code",[t._v("Description")]),t._v(" section of “INIT INFO”.")]),t._v(" "),a("td",[a("code",[t._v("${project.description}")]),t._v("(falling back to "),a("code",[t._v("${task.baseName}")]),t._v(")")]),t._v(" "),a("td",[a("code",[t._v("${project.description}")]),t._v("(falling back to "),a("code",[t._v("${project.name}")]),t._v(")")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("initInfoChkconfig")])]),t._v(" "),a("td",[a("code",[t._v("chkconfig")]),t._v(" section of “INIT INFO”")]),t._v(" "),a("td",[a("code",[t._v("2345 99 01")])]),t._v(" "),a("td",[a("code",[t._v("2345 99 01")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("confFolder")])]),t._v(" "),a("td",[t._v("The default value for "),a("code",[t._v("CONF_FOLDER")])]),t._v(" "),a("td",[t._v("Folder containing the jar")]),t._v(" "),a("td",[t._v("Folder containing the jar")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("inlinedConfScript")])]),t._v(" "),a("td",[t._v("Reference to a file script that should be inlined in the default launch script. This can be used to set environmental variables such as "),a("code",[t._v("JAVA_OPTS")]),t._v(" before any external config files are loaded")]),t._v(" "),a("td"),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[a("code",[t._v("logFolder")])]),t._v(" "),a("td",[t._v("Default value for "),a("code",[t._v("LOG_FOLDER")]),t._v(". Only valid for an "),a("code",[t._v("init.d")]),t._v(" service")]),t._v(" "),a("td"),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[a("code",[t._v("logFilename")])]),t._v(" "),a("td",[t._v("Default value for "),a("code",[t._v("LOG_FILENAME")]),t._v(". Only valid for an "),a("code",[t._v("init.d")]),t._v(" service")]),t._v(" "),a("td"),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[a("code",[t._v("pidFolder")])]),t._v(" "),a("td",[t._v("Default value for "),a("code",[t._v("PID_FOLDER")]),t._v(". Only valid for an "),a("code",[t._v("init.d")]),t._v(" service")]),t._v(" "),a("td"),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[a("code",[t._v("pidFilename")])]),t._v(" "),a("td",[t._v("Default value for the name of the PID file in "),a("code",[t._v("PID_FOLDER")]),t._v(". Only valid for an "),a("code",[t._v("init.d")]),t._v(" service")]),t._v(" "),a("td"),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[a("code",[t._v("useStartStopDaemon")])]),t._v(" "),a("td",[t._v("Whether the "),a("code",[t._v("start-stop-daemon")]),t._v(" command, when it’s available, should be used to control the process")]),t._v(" "),a("td",[a("code",[t._v("true")])]),t._v(" "),a("td",[a("code",[t._v("true")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("stopWaitTime")])]),t._v(" "),a("td",[t._v("Default value for "),a("code",[t._v("STOP_WAIT_TIME")]),t._v(" in seconds. Only valid for an "),a("code",[t._v("init.d")]),t._v(" service")]),t._v(" "),a("td",[t._v("60")]),t._v(" "),a("td",[t._v("60")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("在运行脚本时自定义脚本")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table",[a("thead",[a("tr",[a("th",[t._v("Variable")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("code",[t._v("MODE")])]),t._v(" "),a("td",[t._v("操作的“模式”。 默认值取决于jar的构建方式，但通常是auto（意味着它通过检查它是否是名为init.d的目录中的符号链接来尝试猜测它是否是init脚本）。 您可以显式将其设置为service，以便stop")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("USE_START_STOP_DAEMON")])]),t._v(" "),a("td",[t._v("当start-stop-daemon命令可用时，是否应该使用它来控制进程。默认值为true。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("PID_FOLDER")])]),t._v(" "),a("td",[t._v("pid文件夹的根名称（默认情况下为/ var / run）。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("LOG_FOLDER")])]),t._v(" "),a("td",[t._v("存放日志文件的文件夹的名称(默认情况下是/var/log)。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("CONF_FOLDER")])]),t._v(" "),a("td",[t._v("要从中读取.conf文件的文件夹的名称(默认情况下与jar-file相同)。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("LOG_FILENAME")])]),t._v(" "),a("td",[t._v("LOG_FOLDER中的日志文件的名称(默认情况下"),a("code",[t._v("<appname>")]),t._v(".log)。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("APP_NAME")])]),t._v(" "),a("td",[t._v("如果jar从符号链接运行，脚本将猜测应用程序的名称。如果它不是一个符号链接，或者您想显式地设置应用程序名称，这将非常有用。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("RUN_ARGS")])]),t._v(" "),a("td",[t._v("传递给程序(Spring Boot应用程序)的参数。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("JAVA_HOME")])]),t._v(" "),a("td",[t._v("默认情况下，通过使用路径可以发现java可执行文件的位置，但是如果在$JAVA_HOME/bin/java中有一个可执行文件，则可以显式地设置它。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("JAVA_OPTS")])]),t._v(" "),a("td",[t._v("启动JVM时传递给JVM的选项。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("JARFILE")])]),t._v(" "),a("td",[t._v("jar文件的显式位置，以防脚本用于启动一个实际上没有嵌入的jar。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("DEBUG")])]),t._v(" "),a("td",[t._v("如果不是空的，则在shell进程上设置-x标志，使其更容易看到脚本中的逻辑。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("STOP_WAIT_TIME")])]),t._v(" "),a("td",[t._v("在强制关闭应用程序之前等待的时间(默认为60秒)，以秒为单位。")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("PID_FOLDER，LOG_FOLDER和LOG_FILENAME变量仅对init.d服务有效。 对于systemd，使用“service”脚本进行等效的自定义。 有关更多详细信息，请参阅服务单元配置手册页。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("myapp.conf.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("JAVA_OPTS=-Xmx1024M\nLOG_FOLDER=/custom/log/folder\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("如果不喜欢将配置文件放在jar文件旁边，可以设置con_folder环境变量来定制配置文件的位置。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_64-3-microsoft-windows-services"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_64-3-microsoft-windows-services","aria-hidden":"true"}},[this._v("#")]),this._v(" 64.3 Microsoft Windows Services")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"_65-接下来要读什么"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_65-接下来要读什么","aria-hidden":"true"}},[this._v("#")]),this._v(" 65. 接下来要读什么")])}],!1,null,null,null);e.default=s.exports}}]);